{"version":3,"sources":["webpack:///src/pages/charts/Customer/customerSource.vue","webpack:///./src/pages/charts/Customer/customerSource.vue?b894","webpack:///./src/pages/charts/Customer/customerSource.vue"],"names":["vue_esm","use","vue_router_esm","vuex_esm","customerSource","name","components","Bar","bar","chartsTit","title","RouterLink","routerLink","mybanner","banner","SelectComponent","selectComponent","noData","data","ajaxData","customerSourceData","areaCustomerSourceData","endTime","js","getLocalTime","cityMsg","key1","cusSourcechanrtDom1","cusSourcechanrtDom2","i","customerSourceShow","areaCustomerSourceShow","created","_ref","localStorage","getItem","this","JSON","parse","mounted","getcustomerSourceData","cityName","cityLevel","getareaCustomerSourceData","Object","msManage","computed","extends_default","test","citySelect","state","select","startTimeSelect","endTimeSelect","watch","series","chartsInit","console","log","chartsName","resize","error","beforeDestroy","dispose","methods","date","city","level","_this2","loading","_this","getAjax","tenantId","then","res","_this3","key2","chartsEvent","componentType","Customer_customerSource","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","_v","text","directives","rawName","value","expression","ref","staticRenderFns","Component","__webpack_require__","normalizeComponent","__webpack_exports__"],"mappings":"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","file":"static/js/94.2b2a2b3eb7e07f3c34ca.js","sourcesContent":["<template>\r\n  <div class=\"customerSource paddingTop\">\r\n    <mybanner :title='title'\r\n    />\r\n    <SelectComponent></SelectComponent>\r\n    <div class=\"barBox\">\r\n      <chartsTit :text=\"'客户来源-整体'\">\r\n        <h6>单位：人次</h6>\r\n      </chartsTit>\r\n      <div v-show=\"!customerSourceShow\" ref=\"customerSourceContainer\" ></div>\r\n      <noData v-show=\"customerSourceShow\"></noData>\r\n      <!-- <Bar\r\n      @chartsClick=\"chartsEvent\"\r\n      :data=\"customerSourceData\"\r\n      :vertical=\"'horizontal'\"\r\n      :height=\"100\"></Bar> -->\r\n    </div>\r\n    <div class=\"barBox\">\r\n      <chartsTit :text=\"'客户来源-各店'\">\r\n        <h6>单位：人次</h6>\r\n      </chartsTit>\r\n      <div v-show=\"!areaCustomerSourceShow\" ref=\"areaCustomerSourceContainer\"></div>\r\n      <noData v-show=\"areaCustomerSourceShow\"></noData>\r\n      <!-- <Bar\r\n      @chartsClick=\"chartsEvent\"\r\n      :data=\"areaCustomerSourceData\"\r\n      :vertical=\"'horizontal'\"\r\n      :height=\"400\"></Bar> -->\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport Vue from 'vue'\r\nimport VueRouter from 'vue-router'\r\nimport mango from '../../../js'\r\nimport chartsInit,{chanrtDom, emptyData} from '../../../utils/chartsInit'\r\nimport {waterMark} from '../../../utils/msManage'\r\nimport Vuex, { mapState, mapMutations, mapGetters } from 'vuex'\r\nimport SelectComponent from '../../../components/select/selectComponent'\r\nVue.use(VueRouter)\r\nVue.use(Vuex)\r\nimport Bar from '../../../components/charts/bar'\r\nimport chartsTit from '../../../components/charts/title'\r\nimport RouterLink from '../../../components/charts/routerLink'\r\nimport mybanner from '../../../components/banner'\r\nimport noData from '../../../components/charts/noData'\r\n\r\nexport default {\r\n  name:'customerSource',\r\n  components:{\r\n    Bar,\r\n    chartsTit,\r\n    RouterLink,\r\n    mybanner,\r\n    SelectComponent,\r\n    noData\r\n  },data(){\r\n    return{\r\n      ajaxData: {},\r\n      customerSourceData: {}, \r\n      areaCustomerSourceData: {},\r\n      title:'客户来源报表',\r\n      endTime: mango.getLocalTime('end'),\r\n      cityMsg: '',\r\n      key1:false,\r\n      // key2:false,\r\n      cusSourcechanrtDom1:'',\r\n      cusSourcechanrtDom2:'',\r\n      i:0,\r\n      customerSourceShow: false,\r\n      areaCustomerSourceShow: false\r\n    }\r\n  },  \r\n  created() {\r\n    // 获取本地存储信息\r\n    let [ajaxData, cityMsg] = [localStorage.getItem('ajaxData'), localStorage.getItem('cityMsg')]\r\n    this.cityMsg = cityMsg ? JSON.parse(cityMsg) : {}\r\n    this.ajaxData = JSON.parse(ajaxData)\r\n  },\r\n  mounted(){\r\n    // console.log('数据：', this.citySelect)\r\n    this.getcustomerSourceData(this.endTime, this.cityMsg.cityName, this.cityMsg.cityLevel)\r\n    this.getareaCustomerSourceData(this.endTime)\r\n    waterMark('.barBox')\r\n    \r\n  },\r\n  computed: {\r\n    test() {\r\n      // console.log(333, this.$store)\r\n    },\r\n    ...mapState({\r\n      citySelect: state => state.select.citySelect,\r\n      startTimeSelect: state => state.select.startTimeSelect,\r\n      endTimeSelect: state => state.select.endTimeSelect\r\n    })\r\n  },\r\n  watch: {\r\n    citySelect() {\r\n      if (this.endTimeSelect && this.endTimeSelect != '') {\r\n        this.getcustomerSourceData(this.endTime, this.citySelect.cityName, this.citySelect.cityLevel)\r\n        // this.getpeopleWorkData(this.endTimeSelect, this.citySelect.cityName, this.citySelect.cityLevel)\r\n      }\r\n    },\r\n    endTimeSelect() {\r\n      if (this.endTimeSelect && this.endTimeSelect != '') {\r\n        this.getcustomerSourceData(this.endTimeSelect, this.citySelect.cityName, this.citySelect.cityLevel)\r\n        this.getareaCustomerSourceData(this.endTimeSelect)\r\n        // this.getpeopleWorkData(this.endTimeSelect, this.citySelect.cityName, this.citySelect.cityLevel)\r\n        // this.getareaPeopleWorkData(this.endTimeSelect)\r\n      }\r\n    },\r\n    customerSourceData() {\r\n      const chartsName = 'customerSource'\r\n      if(this.key1) {\r\n        if (this[`${chartsName}Data`].series) {\r\n          // 检测数据是否为空\r\n          this[`${chartsName}Show`] = emptyData(this[`${chartsName}Data`].series)\r\n          chartsInit(this, chartsName, 'horizontal')\r\n          this.cusSourcechanrtDom1 = chanrtDom\r\n        }\r\n      }\r\n    },\r\n    areaCustomerSourceData() {\r\n      console.log(3333333)\r\n      const chartsName = 'areaCustomerSource'\r\n      // if(this.key2) {\r\n        if (this[`${chartsName}Data`].series) {\r\n          // 检测数据是否为空\r\n          this[`${chartsName}Show`] = emptyData(this[`${chartsName}Data`].series)\r\n          console.log(22222221, emptyData(this[`${chartsName}Data`].series))\r\n          chartsInit(this, chartsName, 'horizontal','','','','','',true)\r\n          this.cusSourcechanrtDom2 = chanrtDom\r\n          if(this.i > 1){\r\n            try {\r\n              this.cusSourcechanrtDom2.resize()\r\n            } catch (error) {\r\n              console.log(error)\r\n            }\r\n          }\r\n        }\r\n      // }\r\n    }\r\n  },\r\n  beforeDestroy(){\r\n     //销毁实例\r\n     if(this.cusSourcechanrtDom1) {\r\n      this.cusSourcechanrtDom1.dispose()\r\n     }\r\n     if(this.cusSourcechanrtDom2) {\r\n      this.cusSourcechanrtDom2.dispose()\r\n     }\r\n  },\r\n  methods:{\r\n    ...mapMutations([\r\n      'setHomeTit',\r\n      'setHomeText',\r\n      'setHomeArr'\r\n    ]),\r\n    // goToChild() {\r\n    //   this.$router.push({ path: '/child' })\r\n    // },\r\n    // ajax请求\r\n    getcustomerSourceData(date, city, level) {\r\n      mango.loading('open')\r\n      let _this = this\r\n      mango.getAjax('/v1/app/report/customer/source', {\r\n        cityLevel: level,\r\n        cityName: city,\r\n        // cityName: '苏州市',\r\n        date: date,\r\n        tenantId: this.ajaxData.tenantId\r\n      }).then((res) => {\r\n         mango.loading('close')\r\n        if (res) {\r\n          this.key1= true\r\n          // res = res.data\r\n          // mango.sortYears(res)\r\n          // res.yAxisData = [mango.chartsBotTit(res)]\r\n          // // res.average = res.siblings\r\n          // _this.customerSourceData = res\r\n          res = res.data\r\n          // let arr = res.series\r\n          // let tempObj = {\r\n          //   legendData: ['利润'],\r\n          //   legend:{\r\n          //     data:['2017-08','2018-08','同级客户来源']\r\n          //   },\r\n          //   yAxisData: [\"自然进店\", \"老客带单\", \"异业联盟\", \"设计师介绍\"],\r\n          //   series: [{\r\n          //     \"data\": [ arr[0].data[0],arr[0].data[1],arr[0].data[2],arr[0].data[3] ],\r\n          //     \"name\": \"2018-08\"\r\n          //   }, {\r\n          //     \"data\": [ arr[1].data[0],arr[1].data[1],arr[1].data[2],arr[1].data[3] ],\r\n          //     \"name\": \"2017-08\"\r\n          //   },{\r\n          //     \"data\": [ arr[2].data[0],arr[2].data[1],arr[2].data[2],arr[2].data[3] ],\r\n          //     \"name\": \"同级客户来源\"\r\n          //   }]\r\n          // }\r\n          _this.customerSourceData = res\r\n        }\r\n      })\r\n    },\r\n    getareaCustomerSourceData(date) {\r\n      this.i += 1\r\n      mango.loading('open')\r\n      let _this = this\r\n      mango.getAjax('/v1/app/report/customer/source/shop', {\r\n        date: date,\r\n        tenantId: this.ajaxData.tenantId       \r\n      }).then((res) => {\r\n        mango.loading('close')\r\n        if (res) {\r\n          // let newData = mango.getCustomerNewArr(res.data.series[0].data,res.data.series[1].data,res.data.series[2].data,res.data.series[3].data,res.data.yAxisData)\r\n          // this.$set(res.data.series[0],'data',newData[1])\r\n          // this.$set(res.data.series[1],'data',newData[2])\r\n          // this.$set(res.data.series[2],'data',newData[3])\r\n          // this.$set(res.data.series[3],'data',newData[4])\r\n          // this.$set(res.data,'yAxisData',newData[0])\r\n          this.key2 = true\r\n          res = res.data\r\n          // console.log(res)\r\n          // _this.height = 200\r\n          // let arr = res.series\r\n          // let tempObj = {\r\n          //   legendData: ['利润'],\r\n          //   yAxisData: [\"自然进店\", \"老客带单\", \"异业联盟\", \"设计师介绍\"],\r\n          //   series: [{\r\n          //     \"data\": [ arr[0].data[0],arr[0].data[1],arr[0].data[2],arr[0].data[3] ],\r\n          //     \"name\": \"2018-08\"\r\n          //   }, {\r\n          //     \"data\": [ arr[1].data[0],arr[1].data[1],arr[1].data[2],arr[1].data[3] ],\r\n          //     \"name\": \"2017-08\"\r\n          //   }] \r\n          // }\r\n         \r\n          _this.areaCustomerSourceData = res\r\n        }\r\n      })\r\n    },\r\n    chartsEvent(data) {\r\n      if (data.componentType === \"series\") {\r\n        \r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/charts/Customer/customerSource.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"customerSource paddingTop\"},[_c('mybanner',{attrs:{\"title\":_vm.title}}),_vm._v(\" \"),_c('SelectComponent'),_vm._v(\" \"),_c('div',{staticClass:\"barBox\"},[_c('chartsTit',{attrs:{\"text\":'客户来源-整体'}},[_c('h6',[_vm._v(\"单位：人次\")])]),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.customerSourceShow),expression:\"!customerSourceShow\"}],ref:\"customerSourceContainer\"}),_vm._v(\" \"),_c('noData',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.customerSourceShow),expression:\"customerSourceShow\"}]})],1),_vm._v(\" \"),_c('div',{staticClass:\"barBox\"},[_c('chartsTit',{attrs:{\"text\":'客户来源-各店'}},[_c('h6',[_vm._v(\"单位：人次\")])]),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.areaCustomerSourceShow),expression:\"!areaCustomerSourceShow\"}],ref:\"areaCustomerSourceContainer\"}),_vm._v(\" \"),_c('noData',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.areaCustomerSourceShow),expression:\"areaCustomerSourceShow\"}]})],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-002c2d79\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/charts/Customer/customerSource.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./customerSource.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./customerSource.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-002c2d79\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./customerSource.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/charts/Customer/customerSource.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}
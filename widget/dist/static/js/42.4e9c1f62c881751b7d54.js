webpackJsonp([42],{"/QzT":function(e,a){},"5ZuL":function(e,a){},INC2:function(e,a){},ZDph:function(e,a){},lHPd:function(e,a){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAABdUlEQVRIS92UL0hDURTGvzte0CQYbROTQbDJHPdgsBlWXNFgEYOIRZPdIAjmNcEoGOzizn3MqkEQ/INFWDHZZLufTLbHdNvb29wrvvR455zvxznnfccg5cekrI9/AFDVHQDrAMZJ1o0x7V213qNv7XGScbkByQejqkxzD8Y5d0JyNyVI7btFVb0EsJICpBDNUFXvAcyOCkJyT0SOI0ClUpms1WovACb+CiFZEpGths4PH6jqHIC7PwKurbVLLY0Oo6lqAcDFkJDXarU6UywW6z0BzaXvAzgaEPIZBMF0Lpd7a6/reSpUtQRgMymE5KKIVH7nx94i59wVyWievWAkN0TktFs8FkAy45x7ApCN6eTQWnvQK973moZhOOW9fwYw1kXk3Fq7GjfGvoBGcRiGC977m3YhkrciMt9vR4kADZFyubxmjDlrCr5nMplsPp//GBmg9fsaY5a999si8thPvMPJSQoGzUk8okGFY508rNjAPhgF6AvOC38pYviadwAAAABJRU5ErkJggg=="},msaf:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=t("4YfN"),i=t.n(n),s=t("YV7O"),r=t("xd7I"),l=t("wSez"),o=t("OVlV"),m={render:function(){var e=this,a=e.$createElement,n=e._self._c||a;return n("div",{class:e.show?"foldInput on":"foldInput"},[n("div",{staticClass:"inputBox"},[n("label",[n("span",[e._v(e._s(e.label)),n("span",{directives:[{name:"show",rawName:"v-show",value:e.required,expression:"required"}],staticClass:"yan-red"},[e._v("*")])]),e._v(" "),n("p",[e._v(e._s(e.value))])]),e._v(" "),n("div",{staticClass:"icon-right",on:{click:e.open}},[n("img",{attrs:{src:t("lHPd"),alt:""}})])]),e._v(" "),n("p",{staticClass:"value"},[e._v(e._s(e.value))])])},staticRenderFns:[]};var u=t("C7Lr")({props:["label","required","value"],data:function(){return{show:!1}},watch:{value:function(e,a){e||(this.show=!1)}},methods:{open:function(){this.value?this.show?this.show=!1:this.show=!0:this.show=!1}}},m,!1,function(e){t("5ZuL")},"data-v-1fca18cf",null).exports,c=t("UaEH"),d=t("HVJf"),p={methods:{getDate:function(e){var a=e.getFullYear(),t=e.getMonth()+1,n=e.getDate(),i=e.getHours(),s=e.getMinutes();return a+"-"+(t<10?"0"+t:t)+"-"+(n<10?"0"+n:n)+" "+(i<10?"0"+i:i)+":"+(s<10?"0"+s:s)},format:function(e){if(!e)return"";var a=e.split(" ")[0].split("-"),t=e.split(" ")[1];return a[0]+"年"+parseInt(a[1])+"月"+parseInt(a[2])+"日 "+t}}},f=t("vGYV");r.default.component(l.DatetimePicker.name,l.DatetimePicker);var v={name:"planForm",data:function(){return{startTimeValue:new Date,endTimeValue:new Date,smallStartTimeValue:"00:00",smallEndTimeValue:"00:00"}},mixins:[p],components:{yanInput:o.a,yanTextarea:c.a,yanInfo:u},computed:i()({},Object(d.d)({info:function(e){return e.plan.info},plan:function(e){return e.plan.plan}})),created:function(){},methods:{openStartTime:function(){this.$refs.startTimePicker.open()},openEndTime:function(){this.$refs.endTimePicker.open()},startTimeConfirm:function(){console.log(this.startTimeValue);var e=(new Date).getHours(),a=(new Date).getMinutes(),t=(e<10?"0"+e:e)+":"+(a<10?"0"+a:a);this.smallStartTimeValue=t,this.$refs.smallStartTimePicker.open()},smallStartTimeConfirm:function(){console.log(this.smallStartTimeValue);var e=new Date(this.startTimeValue).getFullYear(),a=new Date(this.startTimeValue).getMonth()+1,t=new Date(this.startTimeValue).getDate(),n=e+"-"+(a<10?"0"+a:a)+"-"+(t<10?"0"+t:t)+" "+this.smallStartTimeValue;this.$set(this.plan,"startTime",n)},endTimeConfirm:function(){console.log(this.endTimeValue);var e=(new Date).getHours(),a=(new Date).getMinutes(),t=(e<10?"0"+e:e)+":"+(a<10?"0"+a:a);this.smallEndTimeValue=t,this.$refs.smallEndTimePicker.open()},smallEndTimeConfirm:function(){console.log(this.smallEndTimeValue);var e=new Date(this.endTimeValue).getFullYear(),a=new Date(this.endTimeValue).getMonth()+1,t=new Date(this.endTimeValue).getDate(),n=e+"-"+(a<10?"0"+a:a)+"-"+(t<10?"0"+t:t)+" "+this.smallEndTimeValue;this.$set(this.plan,"endTime",n)},searchCustomer:function(){this.$router.push({path:"/searchCustomer"})},searchIntention:function(){this.plan.customerId?this.$router.push({path:"/searchIntention"}):f.a.tip("请先选择客户")}}},h={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"planForm"},[t("ul",[t("li",[t("yan-input",e._b({attrs:{maxlength:"50",required:!0},model:{value:e.plan.planName,callback:function(a){e.$set(e.plan,"planName","string"==typeof a?a.trim():a)},expression:"plan.planName"}},"yan-input",e.info.planName,!1))],1),e._v(" "),t("li",{on:{click:e.searchCustomer}},[t("yan-input",e._b({attrs:{readonly:"",showIcon:!0},model:{value:e.plan.customerName,callback:function(a){e.$set(e.plan,"customerName","string"==typeof a?a.trim():a)},expression:"plan.customerName"}},"yan-input",e.info.customerName,!1))],1),e._v(" "),t("li",{on:{click:e.searchIntention}},[t("yan-input",e._b({attrs:{readonly:"",showIcon:!0},model:{value:e.plan.goodsName,callback:function(a){e.$set(e.plan,"goodsName","string"==typeof a?a.trim():a)},expression:"plan.goodsName"}},"yan-input",e.info.goodsName,!1))],1),e._v(" "),t("li",[t("yan-input",e._b({attrs:{maxlength:"30"},model:{value:e.plan.address,callback:function(a){e.$set(e.plan,"address","string"==typeof a?a.trim():a)},expression:"plan.address"}},"yan-input",e.info.address,!1))],1),e._v(" "),t("li",{on:{click:e.openStartTime}},[t("yan-input",e._b({attrs:{value:e.format(e.plan.startTime),required:!0,readonly:"",showIcon:!0}},"yan-input",e.info.startTime,!1))],1),e._v(" "),t("li",{on:{click:e.openEndTime}},[t("yan-input",e._b({attrs:{value:e.format(e.plan.endTime),readonly:"",showIcon:!0}},"yan-input",e.info.endTime,!1))],1),e._v(" "),t("li",[t("yan-textarea",e._b({attrs:{maxlength:"200"},model:{value:e.plan.remark,callback:function(a){e.$set(e.plan,"remark","string"==typeof a?a.trim():a)},expression:"plan.remark"}},"yan-textarea",e.info.remark,!1))],1)]),e._v(" "),t("mt-datetime-picker",{ref:"startTimePicker",attrs:{startDate:new Date,type:"date","year-format":"{value} 年","month-format":"{value} 月","date-format":"{value} 日"},on:{confirm:e.startTimeConfirm},model:{value:e.startTimeValue,callback:function(a){e.startTimeValue=a},expression:"startTimeValue"}}),e._v(" "),t("mt-datetime-picker",{ref:"smallStartTimePicker",attrs:{type:"time","hour-format":"{value} 时","minute-format":"{value} 分"},on:{confirm:e.smallStartTimeConfirm},model:{value:e.smallStartTimeValue,callback:function(a){e.smallStartTimeValue=a},expression:"smallStartTimeValue"}}),e._v(" "),t("mt-datetime-picker",{ref:"endTimePicker",attrs:{startDate:new Date,type:"date","year-format":"{value} 年","month-format":"{value} 月","date-format":"{value} 日"},on:{confirm:e.endTimeConfirm},model:{value:e.endTimeValue,callback:function(a){e.endTimeValue=a},expression:"endTimeValue"}}),e._v(" "),t("mt-datetime-picker",{ref:"smallEndTimePicker",attrs:{type:"time","hour-format":"{value} 时","minute-format":"{value} 分"},on:{confirm:e.smallEndTimeConfirm},model:{value:e.smallEndTimeValue,callback:function(a){e.smallEndTimeValue=a},expression:"smallEndTimeValue"}})],1)},staticRenderFns:[]};var T=t("C7Lr")(v,h,!1,function(e){t("ZDph")},"data-v-0f4146d2",null).exports;r.default.component(l.DatetimePicker.name,l.DatetimePicker);var y={name:"planFormReadonly",data:function(){return{}},mixins:[p],components:{yanInput:o.a,yanTextarea:c.a,yanInfo:u},computed:i()({},Object(d.d)({info:function(e){return e.plan.info},plan:function(e){return e.plan.plan}})),methods:{}},k={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"planForm"},[t("ul",[t("li",[t("yan-input",e._b({attrs:{readonly:""},model:{value:e.plan.planName,callback:function(a){e.$set(e.plan,"planName",a)},expression:"plan.planName"}},"yan-input",e.info.planName,!1))],1),e._v(" "),t("li",[t("yan-input",e._b({attrs:{readonly:"",showIcon:!1},model:{value:e.plan.customerName,callback:function(a){e.$set(e.plan,"customerName",a)},expression:"plan.customerName"}},"yan-input",e.info.customerName,!1))],1),e._v(" "),t("li",[t("yan-info",e._b({attrs:{readonly:""},model:{value:e.plan.goodsName,callback:function(a){e.$set(e.plan,"goodsName",a)},expression:"plan.goodsName"}},"yan-info",e.info.goodsName,!1))],1),e._v(" "),t("li",[t("yan-input",e._b({attrs:{readonly:""},model:{value:e.plan.address,callback:function(a){e.$set(e.plan,"address",a)},expression:"plan.address"}},"yan-input",e.info.address,!1))],1),e._v(" "),t("li",[t("yan-input",e._b({attrs:{value:e.format(e.plan.startTime),readonly:"",showIcon:!1}},"yan-input",e.info.startTime,!1))],1),e._v(" "),t("li",[t("yan-input",e._b({attrs:{value:e.format(e.plan.endTime),readonly:"",showIcon:!1}},"yan-input",e.info.endTime,!1))],1),e._v(" "),t("li",[t("yan-textarea",e._b({attrs:{readonly:!0},model:{value:e.plan.remark,callback:function(a){e.$set(e.plan,"remark",a)},expression:"plan.remark"}},"yan-textarea",e.info.remark,!1))],1)])])},staticRenderFns:[]};var g=t("C7Lr")(y,k,!1,function(e){t("INC2")},"data-v-609434d4",null).exports,b=new(t("0xDb").a),_=t("BvhE").Base64,N={name:"workPlan",props:["id"],data:function(){return{edit:!0,title:""}},components:{banner:s.a,planForm:T,planFormReadonly:g},computed:i()({},Object(d.d)({plan:function(e){return e.plan.plan}})),activated:function(){this.$route.meta.isUseCache||(this.id?(this.edit=!1,this.setPlan({id:this.id}),this.title="计划详情",this.getDetail(this.plan.id)):(this.setPlan({id:""}),this.edit=!0,this.title="新建工作计划"))},mounted:function(){},methods:i()({},Object(d.c)("plan",["setPlan"]),{save:function(){var e=this;if(this.valid(this.plan)){var a=this.getParams(this.plan);console.log(a);var t=new FormData,n=[];for(var i in a)t.append(i,a[i]),n.push(i);this.plan.id?b.updateWorkPlan(t,n,a).then(function(a){console.log(a),f.a.tip(a.msg),e.plan.id&&e.getDetail(e.plan.id)}).catch(function(a){510===a&&e.save()}):b.saveWorkPlan(t,n,a).then(function(a){console.log(a),f.a.tip(a.msg),a.data&&e.getDetail(a.data)}).catch(function(a){510===a&&e.save()})}},getDetail:function(e){var a=this;b.getPlanDetail(e).then(function(e){console.log(e),e.status&&(a.$set(a.plan,"planName",_.decode(e.data.planName)),a.$set(a.plan,"address",""===e.data.address?"":_.decode(e.data.address)),a.$set(a.plan,"startTime",e.data.startTime),a.$set(a.plan,"endTime",e.data.endTime),a.$set(a.plan,"customerId",e.data.customerId),a.$set(a.plan,"customerName",e.data.customerName),a.$set(a.plan,"opportunityId",e.data.opportunityId),a.$set(a.plan,"remark",""===e.data.remark?"":_.decode(e.data.remark)),a.$set(a.plan,"id",e.data.id),a.$set(a.plan,"goodsName",e.data.goodNames),a.edit=!1,a.title="计划详情",console.log("哈哈哈",_.decode("dW5kZWZpbmVk")))}).catch(function(t){510===t&&a.getDetail(e)})},editPlan:function(){this.title="编辑工作计划",this.edit=!0},getParams:function(e){var a={},t={planName:_.encode(e.planName),address:e.address&&""!==e.address?_.encode(e.address):"",startTime:e.startTime,endTime:e.endTime,customerId:e.customerId,customerName:e.customerName,opportunityId:e.opportunityId,remark:e.remark&&""!==e.remark?_.encode(e.remark):"",id:e.id};for(var n in t)(t[n]||0===t[n])&&(a[n]=t[n]);return a},valid:function(e){return e.planName?!!e.startTime||(f.a.tip("请选择开始时间"),!1):(f.a.tip("请填写事件标题"),!1)}}),beforeRouteEnter:function(e,a,t){"searchCustomer"===a.name||"searchIntention"===a.name?e.meta.isUseCache=!0:e.meta.isUseCache=!1,t()}},w={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"newWorkPlan"},[t("banner",{staticClass:"header",attrs:{title:e.title}},[e.edit?t("button",{staticClass:"save",attrs:{type:"button"},on:{click:e.save}},[e._v("保存")]):t("button",{staticClass:"save",attrs:{type:"button"},on:{click:e.editPlan}},[e._v("编辑")])]),e._v(" "),e.edit?t("planForm"):t("planFormReadonly")],1)},staticRenderFns:[]};var D=t("C7Lr")(N,w,!1,function(e){t("/QzT")},"data-v-2e60d8b6",null);a.default=D.exports}});
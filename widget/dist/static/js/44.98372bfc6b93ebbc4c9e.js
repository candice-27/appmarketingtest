webpackJsonp([44],{Luci:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("lC5x"),s=n.n(o),a=n("3cXf"),i=n.n(a),r=n("aA9S"),c=n.n(r),u=n("J0Oq"),l=n.n(u),p=n("4YfN"),m=n.n(p),h=(n("SWMD"),n("xd7I"),n("7LQH"),n("HVJf")),g=n("vGYV"),d=n("84iU"),f=n.n(d),v=n("KPSb"),y=n.n(v),x={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tipsError"},[e("div",{staticClass:"topBox"},[e("div",{staticClass:"imgs"}),this._v(" "),e("span",[this._v("账号或密码错误，请重新输入")])])])}]};var b=n("C7Lr")({name:"tipsError",data:function(){return{}}},x,!1,function(t){n("d+It")},"data-v-6db6cee3",null).exports,_={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tipsWeb"},[e("div",{staticClass:"topBox"},[e("span",[this._v("网络请求错误，请检查网络")])])])}]};var w=n("C7Lr")({},_,!1,function(t){n("g9sg")},null,null).exports,C=n("cyB7"),S=n("veWP"),k=n("fi7s"),B=n("0xDb"),M=n("PR0l"),I=n("sqb0"),V=n.n(I),A=new B.a,D={name:"login",components:{tipsError:b,tipsWeb:w,btn:C.a,myinput:S.a,messageBox:k.a},props:["myStyle"],data:function(){return{height:document.documentElement.clientHeight,text:"登录",checked:!0,display:"none",display1:"none",key:!0,type1:"text",type2:"password",account:"账号",pwd:"密码",inputValue1:"",inputValue2:"",nameMsg:"",pwdMsg:"",h:"",marginTop:"",mergeBoxShow:!1,mergeBox:{tip:"",type:!1,btnNum:2},colorheight:"",botContentShow:!0}},mounted:function(){this.$root.author="mangoguang"},created:function(){this.inputValue1=V.a.get("userName")||"",this.inputValue2=V.a.get("password")||"",this.getAccountMsg(),this.isIPhoneX()},methods:m()({},Object(h.c)(["setPersonMsg"]),{myFocus:function(){this.botContentShow=!1},myBlur:function(){this.botContentShow=!0},onSubmit:function(){this.key=!1,this.display="none",this.display1="none",this.login(this.inputValue1,this.inputValue2)},submitForm:function(){this.key=!1,this.display="none",this.display1="none",this.login(this.inputValue1,this.inputValue2)},isIPhoneX:function(){var t=this.phoneSize();"iphonex"===t?(this.height="54.4",this.marginTop="-5.86vw",this.colorheight="5.86vw"):(this.height="49.26",this.marginTop="",this.colorheight="")},login:function(t,e){var n=this;return l()(s.a.mark(function o(){var a,r,u;return s.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a={grant_type:"password",username:t,password:y()(e)},o.next=3,Object(M.s)(a);case 3:if(500!=(r=o.sent).code){o.next=7;break}return g.a.tip(r.msg),o.abrupt("return");case 7:n.checked?(V.a.set("userName",t),V.a.set("password",e)):(V.a.remove("userName"),V.a.remove("password")),c()(r,{account:t,pwd:e}),u=i()(r),localStorage.setItem("token",u),n.$root.token=r,n.getUserInfo();case 13:case"end":return o.stop()}},o,n)}))()},getUserInfo:function(){var t=this;return l()(s.a.mark(function e(){var n,o,a,r,c,u,l;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(M.x)();case 2:n=e.sent,(o=n.data)&&(localStorage.setItem("userInfo",i()(o)),a=t.getName(o.positionList),r={account:o.account,tenantId:o.tenantId,timestamp:Date.parse(new Date),name:o.username,phone:o.phone,sex:o.sex,type:o.type,typename:a,positionList:o.positionList[0],userId:o.userId},c=i()({crmAccount:o.crmAccount}),u=i()(o.shopList),localStorage.setItem("crmAccount",c),localStorage.setItem("shops",u),localStorage.setItem("ajaxData",i()(r)),localStorage.setItem("certPositionType",o.certPositionType),t.$root.ajaxData=r,o.account!==o.crmAccount?"Dealer Boss"===a||"Boss&Consultant"===a||"Boss&Manager"===a?(t.mergeBoxShow=!1,t.$router.replace({path:"/"})):(l={tip:"当前APP登录账号为"+o.account+"，CRM登录账号"+o.crmAccount+"，不一致，是否修改CRM登录账号为"+o.account+"，修改后使用"+o.account+"登录APP和CRM,是否确定修改？",btnNum:2,type:!1},t.mergeBox=l,t.mergeBoxShow=!0):(t.mergeBoxShow=!1,t.$router.replace({path:"/"})));case 5:case"end":return e.stop()}},e,t)}))()},merge:function(){var t=this;this.mergeBoxShow=!1;var e=this.$root.ajaxData;A.merge({userId:e.userId,account:e.account}).then(function(n){if(n.status){var o={tip:n.msg,btnNum:1,type:!0},s=i()({crmAccount:e.account});localStorage.setItem("crmAccount",s),t.mergeBox=o,t.mergeBoxShow=!0}else{var a={tip:n.msg,btnNum:1,type:!1};t.mergeBox=a,t.mergeBoxShow=!0}}).catch(function(e){510===e&&t.merge()})},cancelMerge:function(){this.mergeBox={tip:"如果需要同步APP与CRM登录账号,请在个人中心点击同步账号",btnNum:1,type:!1},this.mergeBoxShow=!0},cancel:function(){this.$router.replace({path:"/"})},getName:function(t){var e="";if(t&&1===t.length)t.map(function(t){e="Dealer Boss"===t.positionType?"Dealer Boss":"Sleep Consultant"===t.positionType?"Sleep Consultant":"Store Manager"===t.positionType?"Store Manager":t.positionType});else if(t&&t.length>1){t.forEach(function(t){e=""===e?t.positionType:e+"&"+t.positionType}),e=e.split("&");var n="";if(!((e=this.getUnique(e))&&e.length>1))return e=e[0];var o=new RegExp("Dealer Boss",""),s=new RegExp("Sleep Consultant",""),a=new RegExp("Store Manager",""),i=this.filterVirtualName(e);if(console.log(123,i),!i)return e="other";if(console.log("22333",i),e.forEach(function(t){n=""===n?t:n+"&"+t}),console.log("nameStrs",n),o.test(n)&&a.test(n)&&s.test(n))return e="Boss&Manager";if(o.test(n)&&a.test(n))return e="Boss&Manager";if(o.test(n)&&s.test(n))return e="Boss&Consultant";if(o.test(n))return e="Dealer Boss";if(a.test(n)&&s.test(n))return e="Store Manager";if(a.test(n))return e="Store Manager";if(s.test(n))return e="Sleep Consultant"}return e},filterVirtualName:function(t){for(var e=t.length,n=0;n<e;n++)if("Dealer Boss"===t[n]||"Sleep Consultant"===t[n]||"Store Manager"===t[n])return!0;return!1},getUnique:function(t){for(var e={},n=[],o=t.length,s=0;s<o;s++)e[t[s]]||(e[t[s]]="abc",n.push(t[s]));return n},setAccountMsg:function(t,e){var n='{"name":" '+t+'", "pwd": "'+e+'"}';localStorage.setItem("accountMsg",n)},getAccountMsg:function(){var t=localStorage.getItem("accountMsg"),e=JSON.parse(t);if(e){var n=e.name.trim(),o=e.pwd.trim();this.nameMsg=n,this.pwdMsg=o,this.inputValue2=o,this.inputValue1=n}},forgetPwd:function(){this.$router.replace({path:"/ForgetPwd"})},getApi:function(){g.a.loading("open");var t=_this.inputValue1,e=_this.inputValue2,n=g.a.port+"/app/login.api";f()({method:"post",url:n,headers:{UUID:"e10adc3949ba59abbe56e057f20f883e"},timeout:1e4,params:{account:t,password:y()(e)}}).then(function(t){g.a.loading("close");var e=t.data.status;if(200==t.status)if(0==e)_this.display="block",_this.key=!0;else{t=t.data.data;var n=i()(t.shopList);_this.$store.commit("setPersonMsg",t);var o=""+n,s='{\n            "account": "'+t.account+'",\n            "tenantId": "'+t.tenantId+'",\n            "token": "'+t.token+'",\n            "uuid": "'+t.uuid+'",\n            "timestamp": "'+Date.parse(new Date)+'",\n            "name": "'+t.username+'",\n            "phone": "'+t.mobile+'",\n            "sex": "'+t.sex+'",\n            "type":"'+t.type+'"\n          }';localStorage.setItem("ajaxData",s),localStorage.setItem("shops",o),_this.checked?_this.setAccountMsg(_this.inputValue1,_this.inputValue2):_this.setAccountMsg("",""),_this.$router.replace({path:"/"})}else console.log(t.status)}).catch(function(){g.a.loading("close"),_this.display1="block",_this.key=!0})}})},N={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"login_box"},[n("div",{staticClass:"login",style:{marginTop:t.marginTop}},[n("div",{class:""+t.myStyle.loginFix}),t._v(" "),n("div",{staticClass:"topBar"},[n("tips-error",{style:{display:t.display}}),t._v(" "),n("tips-web",{style:{display:t.display1}}),t._v(" "),n("div",{staticClass:"line"}),t._v(" "),n("div",{staticClass:"sriangle"})],1),t._v(" "),n("div",{staticClass:"login"},[n("div",{staticClass:"box"},[n("div",{staticClass:"welcome"},[t._v("Hi,")]),t._v(" "),n("h1",[t._v("欢迎使用慕思营销助手")]),t._v(" "),n("form",[n("ul",[n("myinput",{tag:"li",attrs:{type:t.type1,labelContent:t.account,value:t.inputValue1,autocomplete:"off",Msg:t.nameMsg},on:{myFocus:t.myFocus,myBlur:t.myBlur},model:{value:t.inputValue1,callback:function(e){t.inputValue1="string"==typeof e?e.trim():e},expression:"inputValue1"}}),t._v(" "),n("myinput",{tag:"li",attrs:{type:t.type2,labelContent:t.pwd,value:t.inputValue2,Msg:t.pwdMsg},on:{myFocus:t.myFocus,myBlur:t.myBlur,onSubmit:t.onSubmit},model:{value:t.inputValue2,callback:function(e){t.inputValue2="string"==typeof e?e.trim():e},expression:"inputValue2"}}),t._v(" "),n("li",{staticClass:"tips clearfix"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"checked"}],attrs:{type:"checkbox",id:"remember",name:"remember",value:"remember"},domProps:{checked:Array.isArray(t.checked)?t._i(t.checked,"remember")>-1:t.checked},on:{change:function(e){var n=t.checked,o=e.target,s=!!o.checked;if(Array.isArray(n)){var a=t._i(n,"remember");o.checked?a<0&&(t.checked=n.concat(["remember"])):a>-1&&(t.checked=n.slice(0,a).concat(n.slice(a+1)))}else t.checked=s}}}),t._v(" "),n("label",{staticClass:"rem",attrs:{for:"remember"}}),t._v(" "),t._m(0),t._v(" "),n("div",{staticClass:"forgetpwd",on:{touchend:t.forgetPwd}},[t._v("忘记密码?")])]),t._v(" "),n("li",[n("btn",{staticClass:"myBtn",attrs:{text:t.text},nativeOn:{click:function(e){return t.submitForm()}}})],1)],1)])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.botContentShow,expression:"botContentShow"}],staticClass:"wechatLogin",style:{height:t.h}},[t._m(1),t._v(" "),n("div",{staticClass:"wechat-icon"})]),t._v(" "),n("div",{staticClass:"fixBottom",style:{height:t.colorheight}})]),t._v(" "),n("message-box",t._b({directives:[{name:"show",rawName:"v-show",value:t.mergeBoxShow,expression:"mergeBoxShow"}],scopedSlots:t._u([{key:"btn-group",fn:function(){return[n("button",{attrs:{type:"button"},on:{click:t.merge}},[t._v("确定")]),t._v(" "),n("button",{attrs:{type:"button"},on:{click:t.cancelMerge}},[t._v("取消")])]},proxy:!0},{key:"btn",fn:function(){return[n("button",{attrs:{type:"button"},on:{click:t.cancel}},[t._v("确定")])]},proxy:!0}])},"message-box",t.mergeBox,!1),[n("p",{attrs:{id:"tip"}},[t._v(t._s(t.mergeBox.tip))])])],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:"remember"}},[e("div",{staticClass:"rempwd"},[this._v("记住密码")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"wechatText"},[e("hr"),this._v(" "),e("span",[this._v("第三方账号登录")]),this._v(" "),e("hr")])}]};var P=n("C7Lr")(D,N,!1,function(t){n("im0N")},"data-v-7beb7eb8",null);e.default=P.exports},"d+It":function(t,e){},g9sg:function(t,e){},im0N:function(t,e){},sqb0:function(t,e,n){var o,s;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(a){if(void 0===(s="function"==typeof(o=a)?o.call(e,n,e,t):o)||(t.exports=s),!0,t.exports=a(),!!0){var i=window.Cookies,r=window.Cookies=a();r.noConflict=function(){return window.Cookies=i,r}}}(function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var o in n)e[o]=n[o]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(o){function s(){}function a(e,n,a){if("undefined"!=typeof document){"number"==typeof(a=t({path:"/"},s.defaults,a)).expires&&(a.expires=new Date(1*new Date+864e5*a.expires)),a.expires=a.expires?a.expires.toUTCString():"";try{var i=JSON.stringify(n);/^[\{\[]/.test(i)&&(n=i)}catch(t){}n=o.write?o.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var r="";for(var c in a)a[c]&&(r+="; "+c,!0!==a[c]&&(r+="="+a[c].split(";")[0]));return document.cookie=e+"="+n+r}}function i(t,n){if("undefined"!=typeof document){for(var s={},a=document.cookie?document.cookie.split("; "):[],i=0;i<a.length;i++){var r=a[i].split("="),c=r.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=e(r[0]);if(c=(o.read||o)(c,u)||e(c),n)try{c=JSON.parse(c)}catch(t){}if(s[u]=c,t===u)break}catch(t){}}return t?s[t]:s}}return s.set=a,s.get=function(t){return i(t,!1)},s.getJSON=function(t){return i(t,!0)},s.remove=function(e,n){a(e,"",t(n,{expires:-1}))},s.defaults={},s.withConverter=n,s}(function(){})})}});
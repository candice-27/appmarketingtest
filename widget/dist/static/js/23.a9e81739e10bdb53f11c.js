webpackJsonp([23],{"+k4m":function(t,e){},Vhou:function(t,e,a){"use strict";var n=new(a("7+uW").default);e.a=n},ZEmc:function(t,e,a){"use strict";var n=a("vGYV"),i={name:"myDatePicker",components:{},props:["curMonthData"],data:function(){return{year:null,month:null,day:null,curDate:null,dateList:[],selectDate:""}},watch:{curMonthData:function(t){t.length&&(console.log(t),this.dateList=t.map(function(t){return t.createTime}),console.log(this.dateList))}},created:function(){this.getDate()},mounted:function(){},computed:{getBeginDay:function(){return console.log("getBeginDay",new Date(this.year,this.month-1,1).getDay()),new Date(this.year,this.month-1,1).getDay()},curDay:function(){return console.log("getBeginDay111",new Date(this.year,this.month,0).getDate()),new Date(this.year,this.month,0).getDate()},prevDay:function(){return console.log("getBeginDay2222",new Date(this.year,this.month-1,0).getDate()),new Date(this.year,this.month-1,0).getDate()}},methods:{getDate:function(){var t=new Date;this.year=t.getFullYear(),this.month=t.getMonth()+1,this.day=t.getDate(),this.curDate=this.year+"-"+this.month+"-"+this.day,this.selectDate=this.year+"-"+this.month+"-"+this.day},changeCurDay:function(t){this.day=t,this.selectDate=this.year+"-"+this.month+"-"+this.day,this.$emit("getCurDay",this.year+"年"+this.month+"月"+t+"日")},prevMonth:function(){1===this.month?(this.year--,this.month=12):this.month--,this.$emit("changeCurMonthData",this.year+"-"+(this.month<10?"0"+this.month:this.month))},nextMonth:function(){12===this.month?(this.year++,this.month=1):this.month++,this.$emit("changeCurMonthData",this.year+"-"+(this.month<10?"0"+this.month:this.month))},noSummary:function(t){this.curDate===this.year+"-"+this.month+"-"+t?this.$router.push({path:"/newPlan"}):n.a.tip("当日无总结！")},dateCompare:function(t,e){var a=[t.split("-"),e.split("-")],n=a[0],i=a[1];return console.log(parseInt(n[0]),parseInt(i[0])),parseInt(n[0])===parseInt(i[0])?!(parseInt(n[1])<=parseInt(i[1]))||parseInt(n[1])===parseInt(i[1])&&!(parseInt(n[2])<=parseInt(i[2])):!(parseInt(n[0])<parseInt(i[0]))},dateListCompare:function(t){return this.dateList.map(function(t){return t.substr(0,10)}).includes(t)}}},s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"myDatePicker"},[n("div",{staticClass:"date-header"},[n("div",{staticClass:"prev-month",on:{click:t.prevMonth}},[n("img",{attrs:{src:a("EsD4"),alt:""}})]),t._v(" "),n("div",{staticClass:"show-date"},[t._v(t._s(t.year+"."+(t.month<10?"0"+t.month:t.month)))]),t._v(" "),n("div",{staticClass:"next-month",on:{click:t.nextMonth}},[n("img",{attrs:{src:a("Zhbr"),alt:""}})])]),t._v(" "),n("div",{staticClass:"date-content"},[t._m(0),t._v(" "),n("ul",{staticClass:"week-day"},t._l(42,function(e,a){return n("li",{key:"every_day"+a,staticClass:"every-day"},[e-t.getBeginDay>0&&e-t.getBeginDay<=t.curDay?n("span",{class:{"now-day":t.year+"-"+t.month+"-"+(e-t.getBeginDay)===t.curDate,"active-day":t.year+"-"+t.month+"-"+(e-t.getBeginDay)===t.selectDate,summary:t.dateListCompare(t.year+"-"+(t.month<10?"0"+t.month:t.month)+"-"+(e-t.getBeginDay<10?"0"+(e-t.getBeginDay):e-t.getBeginDay)),"future-day":t.dateCompare(t.year+"-"+t.month+"-"+(e-t.getBeginDay),t.curDate)},on:{click:function(a){t.dateListCompare(t.year+"-"+(t.month<10?"0"+t.month:t.month)+"-"+(e-t.getBeginDay<10?"0"+(e-t.getBeginDay):e-t.getBeginDay))?t.changeCurDay(e-t.getBeginDay):t.noSummary(e-t.getBeginDay)}}},[t._v("\n        "+t._s(e-t.getBeginDay)+"\n        ")]):t._e()])}),0)])])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"week-header"},[a("li",[t._v("日")]),t._v(" "),a("li",[t._v("一")]),t._v(" "),a("li",[t._v("二")]),t._v(" "),a("li",[t._v("三")]),t._v(" "),a("li",[t._v("四")]),t._v(" "),a("li",[t._v("五")]),t._v(" "),a("li",[t._v("六")])])}]};var r=a("VU/8")(i,s,!1,function(t){a("aKmB")},"data-v-2913736e",null);e.a=r.exports},aKmB:function(t,e){},hcK7:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("YV7O"),i=a("TCbq"),s=a("vGYV"),r=a("7+uW"),o=a("Au9i"),l={name:"mixin",data:function(){return{}},created:function(){},methods:{getCurDate:function(t){var e=t.getFullYear(),a=t.getMonth()+1,n=t.getDate();return[e+"年"+a+"月"+n+"日",e+"-"+(a<10?"0"+a:a)+"-"+n]}}};r.default.component(o.DatetimePicker.name,o.DatetimePicker);var c={name:"",props:["list"],mixins:[l],data:function(){return{pickerVisible:new Date,img:"./static/images/date.png",date:""}},created:function(){this.date=this.getCurDate(new Date)[0]},methods:{openPicker:function(){this.$refs.date.open()},handleConfirm:function(){var t=new Date(this.pickerVisible).getFullYear(),e=new Date(this.pickerVisible).getMonth()+1,a=new Date(this.pickerVisible).getDate();this.date=t+"年"+e+"月"+a+"日",this.$emit("getPickerDate",t+"-"+(e<10?"0"+e:e)+"-"+a)}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"timePicker"},[a("div",{staticClass:"time"},[t._v(t._s(t.date))]),t._v(" "),a("img",{attrs:{src:t.img,alt:""},on:{click:t.openPicker}}),t._v(" "),a("mt-datetime-picker",{ref:"date",attrs:{type:"date","year-format":"{value} 年","month-format":"{value} 月","date-format":"{value} 日",endDate:new Date},on:{confirm:t.handleConfirm},model:{value:t.pickerVisible,callback:function(e){t.pickerVisible=e},expression:"pickerVisible"}})],1)},staticRenderFns:[]};var h=a("VU/8")(c,u,!1,function(t){a("+k4m")},"data-v-0dd22e22",null).exports,m=a("v+Lu"),y=a("0xDb"),d=new y.a,D={name:"employeeDailyList",mixins:[l],data:function(){return{img:"./static/images/avatar.png",date:"",status:"",list:[],top:"",scroll:0}},components:{timeSelect:h,employeeLi:m.a},created:function(){this.isIphoneX(),this.date=this.getCurDate(new Date)[1],this.getStaffDailyList({date:this.date})},mounted:function(){this.listen()},methods:{getPickerDate:function(t){this.date=t,this.getStaffDailyList({date:this.date})},getStaffDailyList:function(t){var e=this;d.getStaffDailyList(t).then(function(t){console.log(t),1===t.status&&(e.list=t.data,e.scroll>0&&(e.$refs.perDailyList.scrollTop=0,e.scroll=0))}).catch(function(a){510===a&&e.getStaffDailyList(t)})},getDaily:function(t){console.log("isDailyOk",t.dailyOk),t.dailyOk?this.go(t.userId,t.userName,t.createTime,t.shopId):s.a.tip("未提交日报")},go:function(t,e,a,n){var i=a.split(" ")[0];this.$router.push({name:"employeeDailyReport",params:{id:t,username:e,date:i,shopId:n}})},isIphoneX:function(){"iphonex"===this.phoneSize()?"Store Manager"!==this._localAjax().typename?this.top="22.35":this.top="34.612":"Store Manager"!==this._localAjax().typename?this.top="16.35":this.top="28.612"},handleScroll:function(t){this.scroll=t.target.scrollTop,console.log(this.scroll)},listen:function(){this.$refs.perDailyList.addEventListener("scroll",this.handleScroll,!0),this.$refs.perDailyList.scrollTop=this.scroll}}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"perDailyList",staticClass:"perDailyList",style:{marginTop:"Store Manager"!==t._localAjax().typename?"19.12vw":"31.619vw"}},[a("div",{staticClass:"timeBox",style:{top:t.top+"vw"}},[a("timeSelect",{on:{getPickerDate:t.getPickerDate}})],1),t._v(" "),t._l(t.list,function(e,n){return a("ul",{key:n,on:{click:function(a){return t.getDaily(e)}}},[a("employeeLi",{tag:"li",attrs:{icon:e.dailyOk}},[a("div",{staticClass:"headPortrait",attrs:{slot:"headPortrait"},slot:"headPortrait"},[a("img",{attrs:{src:t.img,alt:""}})]),t._v(" "),a("div",{staticClass:"detail"},[a("div",[a("h1",[t._v(t._s(e.userName)+" "),"Store Manager"!==t._localAjax().typename?a("span",[t._v("店长")]):t._e()]),t._v(" "),a("p",[t._v(t._s(e.shopName))])]),t._v(" "),e.dailyOk?a("div",[a("b",{staticClass:"yes"},[t._v("已提交")]),t._v(" "),a("br"),t._v(" "),a("i",[t._v(t._s(e.createTime.split(" ")[1].substr(0,5)))])]):a("div",[a("b",[t._v("未提交")])])])])],1)})],2)},staticRenderFns:[]};var p=a("VU/8")(D,g,!1,function(t){a("rnVK")},"data-v-0e6f7f5e",null).exports,f=a("bOdI"),v=a.n(f),_=a("ZEmc"),x=a("Ceoi"),C=a("+4/w"),T=a("GW3N"),P=a("Vhou"),S=(a("NYxO"),new y.a),k=a("xrTZ").Base64,b={name:"perdailyReporxt",components:{myDatePicker:_.a,banner:n.a,CurReport:x.a,DailySummary:C.a,DailyPlan:T.a,tabUI:i.a,employeeDailyList:p},props:[],data:function(){var t;return t={dailyList:{cus:3,cusBusiness:2,guestSingleValue:52439,opp:3,tourist:1,trackRecord:2,turnoverRatio:1,volumeBusiness:157318},curDay:null,curDate:null,curNum:null,curMonthData:[],dailySummaryTextarea:"",dailyPlanTextarea:"",planList:[]},v()(t,"dailyList",[]),v()(t,"tabList",[{title:"个人日报",status:!0},{title:"员工日报",status:!1}]),t},computed:{},created:function(){P.a.$on("dailyPlanTextarea",function(t){console.log("dailyPlanTextarea",t)})},mounted:function(){this.curDay=this.getToday(),this.curDate=this.curDay.split(/年|月|日/);var t=new Date,e=[t.getFullYear(),t.getMonth()+1,t.getDate()],a=e[0],n=e[1],i=e[2];this.curNum=parseInt(t.getDate()),this.getCurMonthData(this.getCurMonth()),this.getDailyData({startDate:a+"-"+n+"-"+i,endDate:a+"-"+n+"-"+i,QueryYourself:1})},methods:{getCurDay:function(t){this.curDay!==t&&(this.curDay=t,this.curDate=t.split(/年|月|日/),this.curNum=this.curDate[2],this.setSumAndPlan(this.curMonthData),this.getDailyData({startDate:this.curDate[0]+"-"+this.curDate[1]+"-"+this.curDate[2],endDate:this.curDate[0]+"-"+this.curDate[1]+"-"+this.curDate[2],QueryYourself:1}))},changeCurMonthData:function(t){this.getCurMonthData(t)},getCurMonth:function(){var t=new Date,e=[t.getFullYear(),t.getMonth()+1],a=e[1];return a<10&&(a="0"+a),e[0]+"-"+a},changeDailySummaryTextarea:function(t){this.dailySummaryTextarea=t,this.$emit("changeDailySummaryTextarea",t)},changeDailyPlanTextarea:function(t){this.dailyPlanTextarea=t,this.$emit("changeDailyPlanTextarea",t)},getToday:function(){var t=new Date;return t.getFullYear()+"年"+(t.getMonth()+1)+"月"+t.getDate()+"日"},getCurMonthData:function(t){var e=this;console.log(t),S.getCurMonthData({date:t}).then(function(t){(t=t.data)&&(console.log(t),e.curMonthData=t,e.curNum&&e.setSumAndPlan(t))}).catch(function(a){510===a&&e.getCurMonthData(t)})},setSumAndPlan:function(t){var e=parseInt(this.curNum),a=[],n=[];if(t){a=t.map(function(t){return parseInt(t.createTime.substr(8,2))}),n=t.map(function(t){return t.createTime.substr(0,10)}),console.log("日期",n);var i=a.indexOf(e);if(i>=0){var r=this.curDate[0]+"/"+this.curDate[1]+"/"+this.curDate[2];console.log("日期",r),new Date(r)<s.a.setReportTime()?(this.dailySummaryTextarea=t[i].summarize,this.dailyPlanTextarea=t[i].plan):(this.dailySummaryTextarea=k.decode(t[i].summarize),this.dailyPlanTextarea=k.decode(t[i].plan)),this.$emit("changeDailySummaryTextarea",this.dailySummaryTextarea),this.$emit("changeDailyPlanTextarea",this.dailyPlanTextarea)}}},getDailyData:function(t){var e=this;S.getDailyReport(t).then(function(t){t.data&&(console.log(t),e.dailyList=t.data)}).catch(function(a){510===a&&e.getDailyData(t)})}}},M={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("myDatePicker",{attrs:{curMonthData:t.curMonthData},on:{getCurDay:t.getCurDay,changeCurMonthData:t.changeCurMonthData}}),t._v(" "),a("CurReport",{attrs:{list:t.dailyList,curDay:t.curDay}}),t._v(" "),a("DailySummary",{attrs:{text:t.dailySummaryTextarea,disabled:!1},on:{changeDailySummaryTextarea:t.changeDailySummaryTextarea}}),t._v(" "),a("DailyPlan",{attrs:{text:t.dailyPlanTextarea,disabled:!1},on:{changeDailyPlanTextarea:t.changeDailyPlanTextarea}})],1)},staticRenderFns:[]};var w=a("VU/8")(b,M,!1,function(t){a("nmoj")},"data-v-18000e3a",null).exports,L=(new y.a,a("xrTZ").Base64,{name:"dailyReporxt",components:{banner:n.a,tabUI:i.a,employeeDailyList:p,storeDailyReport:w},props:[],data:function(){return{tabList:[{title:"个人日报",status:!0},{title:"员工日报",status:!1}],dailySummaryTextarea:"",dailyPlanTextarea:""}},computed:{},created:function(){},mounted:function(){},methods:{changeDailySummaryTextarea:function(t){this.dailySummaryTextarea=t},changeDailyPlanTextarea:function(t){this.dailyPlanTextarea=t},newPlan:function(){""===this.dailySummaryTextarea&&""===this.dailyPlanTextarea?this.$router.push({path:"/newPlan"}):s.a.tip("当日已提交日报，请勿重复提交！")},getIndex:function(t){console.log(t);var e=this.tabList.map(function(e,a){return e.status=a===t,e});this.tabList=e}},beforeRouteEnter:function(t,e,a){"employeeDailyReport"===e.name?a(function(t){t.getIndex(1)}):a(function(t){t.getIndex(0)})}}),I={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dailyReport"},[a("banner",{staticClass:"header",attrs:{title:"Store Manager"===t._localAjax().typename?"日报":"员工日报"}},["Store Manager"===t._localAjax().typename&&t.tabList[0].status?a("button",{staticClass:"newDailyReport",on:{click:t.newPlan}}):t._e()]),t._v(" "),"Store Manager"===t._localAjax().typename?a("tabUI",{attrs:{list:t.tabList},on:{getIndex:t.getIndex}}):t._e(),t._v(" "),"Store Manager"===t._localAjax().typename&&t.tabList[0].status?a("div",{staticClass:"perDaily"},[a("storeDailyReport",{on:{changeDailySummaryTextarea:t.changeDailySummaryTextarea,changeDailyPlanTextarea:t.changeDailyPlanTextarea}})],1):a("div",[a("employeeDailyList")],1)],1)},staticRenderFns:[]};var B=a("VU/8")(L,I,!1,function(t){a("x1sA")},"data-v-2e8b9326",null);e.default=B.exports},nmoj:function(t,e){},rnVK:function(t,e){},x1sA:function(t,e){}});
//# sourceMappingURL=23.a9e81739e10bdb53f11c.js.map
webpackJsonp([69],{Fc2Z:function(e,t){},jFxb:function(e,t){},owpE:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("7+uW"),r=(o("NYxO"),o("8BZo")),n=o("Au9i"),i=o("oelh"),c=o("vUBu"),l=o("WdeC"),s=o("vGYV"),m=o("CqDD");a.default.component(n.DatetimePicker.name,n.DatetimePicker);var d={name:"recordForm",components:{remark:i.a,myRange:c.a,customerLi:l.a},props:["btns"],data:function(){return{today:new Date,recordForm:{}}},watch:{},created:function(){var e=localStorage.getItem("ajaxData");this.ajaxData=JSON.parse(e)},mounted:function(){this.recordForm.percent=50,this.emitParentEvent()},methods:{changeMyRangeVal:function(e){this.recordForm.percent=e,this.emitParentEvent()},changeFollowSituation:function(){this.emitParentEvent()},changeFollowPlan:function(){this.emitParentEvent()},selectTime:function(){this.$refs.followDatePicker.open()},setTime:function(e){this.$set(this.recordForm,"followTime",s.a.indexTimeB(e)[0]),this.emitParentEvent()},emitParentEvent:function(){console.log(this.recordForm),this.$emit("getRecordForm",this.recordForm)}}},u={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("ul",{staticClass:"recordForm"},[o("li",{staticClass:"noPadding"},[o("remark",{attrs:{title:"跟进情况"}},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.recordForm.followSituation,expression:"recordForm.followSituation"}],attrs:{placeholder:"描述一下跟进情况"},domProps:{value:e.recordForm.followSituation},on:{change:e.changeFollowSituation,input:function(t){t.target.composing||e.$set(e.recordForm,"followSituation",t.target.value)}}})])],1),e._v(" "),o("li",[o("my-range",{attrs:{title:"成交概率"},on:{changeVal:e.changeMyRangeVal}})],1),e._v(" "),o("customerLi",{tag:"li",staticClass:"timeLi",attrs:{leftText:"下次跟进时间",icon:!0},nativeOn:{click:function(t){return e.selectTime(t)}}},[o("span",[e._v(e._s(e.recordForm.followTime||"请选择下次跟进时间"))])]),e._v(" "),o("li",{staticClass:"noPadding"},[o("remark",{attrs:{title:"跟进计划"}},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.recordForm.followPlan,expression:"recordForm.followPlan"}],attrs:{placeholder:"接下来该怎么跟进呢？"},domProps:{value:e.recordForm.followPlan},on:{change:e.changeFollowPlan,input:function(t){t.target.composing||e.$set(e.recordForm,"followPlan",t.target.value)}}})])],1)],1),e._v(" "),o("mt-datetime-picker",{ref:"followDatePicker",attrs:{type:"date",startDate:new Date,"year-format":"{value} 年","month-format":"{value} 月","date-format":"{value} 日"},on:{confirm:e.setTime},model:{value:e.today,callback:function(t){e.today=t},expression:"today"}})],1)},staticRenderFns:[]};var f=o("VU/8")(d,u,!1,function(e){o("jFxb")},"data-v-62c16fc1",null).exports,v=o("YV7O"),h={name:"myRange",components:{bigBtn:r.a,recordForm:f,myBanner:v.a},props:["title"],data:function(){return{rangeValue:50,recordFormData:{}}},watch:{rangeValue:function(){this.$emit("changeVal",this.rangeValue)}},created:function(){var e=localStorage.getItem("ajaxData");this.ajaxData=JSON.parse(e),this.demandId=this.$route.query.demandId;var t=new Date;this.$set(this.recordFormData,"followTime",s.a.indexTimeB(t)[0])},methods:{getRecordForm:function(e){console.log("父组建的数据：",e),this.recordFormData=e},saveRecord:function(){var e=this,t=this.recordFormData,o=[t.followSituation,t.followPlan],a=o[0],r=o[1];a&&""!=a?r&&""!=r?s.a.getAjax(this,"saveTrackRecord",{account:this.ajaxData.account,demandId:this.$route.query.demandId,probability:t.percent+"%",nextFollowTime:Object(m.e)(t.followTime)||s.a.indexTimeB(new Date)[1],followPlan:t.followPlan||"",followSituation:t.followSituation||""},"v2","post").then(function(t){t&&n.MessageBox.alert("保存成功！").then(function(t){e.$router.go(-1)})}).catch(function(t){510===t&&e.saveRecord()}):(console.log(t),s.a.tip("请填写跟进计划。")):s.a.tip("请填写跟进情况。")}}},g={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"recordFormBox"},[o("my-banner",{attrs:{title:"新建洽谈记录"}}),e._v(" "),o("record-form",{on:{getRecordForm:e.getRecordForm}}),e._v(" "),o("div",{staticClass:"btnBox"},[o("big-btn",{attrs:{text:"保存"},nativeOn:{click:function(t){return e.saveRecord(t)}}})],1)],1)},staticRenderFns:[]};var F=o("VU/8")(h,g,!1,function(e){o("Fc2Z")},"data-v-779528d1",null);t.default=F.exports}});
//# sourceMappingURL=69.632891b7ffabf8b32b67.js.map
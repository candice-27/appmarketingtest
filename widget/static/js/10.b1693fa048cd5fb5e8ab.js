webpackJsonp([10],{"/4Fq":function(t,e){},"3jcx":function(t,e){},"7d3Z":function(t,e){},E2nm:function(t,e,s){"use strict";var n=s("4YfN"),a=s.n(n),r=s("vRRp"),i=s("HVJf"),o={props:["list","phone","orgId","isedit"],components:{intentionLi:r.a},data:function(){return{show:!0}},methods:a()({},Object(i.c)(["setCheckedList"]),{toIntentionDetails:function(t){this.$router.push({name:"intention",params:{opportunityId:this.list[t].oppId},query:{phone:this.phone,edit:this.isedit}})},newCustomer:function(){this.$router.push({path:"newIntention",query:{id:this.$route.query.id,orgId:this.orgId}})}})},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"intentionMsg"},[s("ul",t._l(t.list,function(e,n){return s("intentionLi",{key:n,attrs:{list:e},nativeOn:{click:function(e){return t.toIntentionDetails(n)}}})}),1),t._v(" "),"no"!==t.isedit?s("button",{staticClass:"new",on:{click:t.newCustomer}}):t._e()])},staticRenderFns:[]};var c=s("C7Lr")(o,u,!1,function(t){s("/4Fq")},"data-v-4c39baa8",null);e.a=c.exports},RqK9:function(t,e,s){"use strict";var n=s("4YfN"),a=s.n(n),r=(s("xd7I"),s("e1F6"),s("HVJf")),i=s("Dt+X"),o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"personalLevel"},[s("div",{staticClass:"content"},[s("div",{staticClass:"total-money"},[s("p",[t._v("订单总金额")]),t._v(" "),s("p",{staticClass:"money"},[t._v("￥"),s("span",{staticClass:"strong"},[t._v(t._s(Math.round(t.list.total)))])])]),t._v(" "),s("div",{staticClass:"numberOfOrder"},[s("p",[t._v("客户订单数")]),t._v(" "),s("p",{staticClass:"strong"},[t._v(t._s(t.count))])])])])},staticRenderFns:[]};var u=s("C7Lr")({props:["list"],data:function(){return{count:""}},watch:{list:function(){this.count=this.list.orderList.length}},methods:{}},o,!1,function(t){s("fGnC")},"data-v-c5002d96",null).exports,c=(s("vGYV"),{name:"dealOrderInfoDetails",props:["list"],components:{OrderInfoDetails:i.a,personalLevel:u},data:function(){return{rotate:-1,status:!1,i:-1,dealTotalPrice:0,dealDiscountPrice:0}},computed:a()({},Object(r.d)({dealOrderInfoDetails:function(t){return t.dealOrderInfoDetails.dealOrderInfoDetails},totalPrice:function(t){return t.dealOrderInfoDetails.totalPrice},discountPrice:function(t){return t.dealOrderInfoDetails.discountPrice}})),mounted:function(){console.log("list",this.list)},methods:{pullDown:function(t){this.status?this.rotate==t?(this.i=-1,this.status=!1,this.rotate=-1):(this.i=t,this.rotate=t):(this.status=!0,this.rotate=t,this.i=t)}}}),d={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"orderInfo"},[n("personalLevel",{attrs:{list:t.list}}),t._v(" "),n("ul",[t._m(0),t._v(" "),t._l(t.list.orderList,function(e,a){return n("li",{key:a,on:{click:function(e){return t.pullDown(a)}}},[0!==a?n("hr"):t._e(),t._v(" "),n("div",{staticClass:"orderList"},[n("span",[t._v(t._s(a+1))]),t._v(" "),n("span",[t._v("订单号"+t._s(e.orderNo))]),t._v(" "),n("span",[t._v(t._s(e.status))]),t._v(" "),n("span",[n("img",{class:{pullDown:""+t.rotate==a},attrs:{src:s("4ral"),alt:""}})])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.i==a,expression:"i == index"}],staticClass:"setLine"},[n("OrderInfoDetails",{attrs:{list:t.list.orderList[a]}})],1)])})],2)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"topBar"},[e("span",[this._v("订单号")]),this._v(" "),e("span",[this._v("订单状态")])])}]};var l=s("C7Lr")(c,d,!1,function(t){s("fnzr")},"data-v-6e32b106",null);e.a=l.exports},fGnC:function(t,e){},fnzr:function(t,e){},lEMZ:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("a3Yh"),a=s.n(n),r=s("lC5x"),i=s.n(r),o=s("J0Oq"),u=s.n(o),c=s("4YfN"),d=s.n(c),l=s("wSez"),h=s("0xDb"),f=s("CNcc"),p=s("iNX8"),v=s("A4bO"),m=s("RqK9"),g=s("lsPn"),w=s("E2nm"),C=s("cyB7"),_=s("HVJf"),I=s("vGYV"),b=s("zIWf"),x=s("Dt+X"),k=s("CqDD"),S=s("TYi7"),D=new h.a,y=a()({components:{EnquiryOrderInfo:b.a,orderInfoDetails:x.a,dealHeader:p.a,OrderInfo:m.a,CustomerMsg:g.a,newDescript:v.a,btn:C.a,intentionMsg:w.a},data:function(){return{list:{},type:[],editStatus:!1,shops:"",shpoId:"",index:"",phone:"",wechat:"",edit:""}},computed:d()({},Object(_.d)({orderInfoDetails:function(t){return t.orderInfoDetails.orderInfoDetails},dealTabStatus:function(t){return t.tabStatus.dealTabStatus},newCustomerInfo:function(t){return t.customer.newCustomerInfo},upLoadUrl:function(t){return t.loadImgUrl.upLoadUrl},descriptShopVal:function(t){return t.chooseShop.descriptShopVal}})),beforeRouteEnter:function(t,e,s){s(function(t){"selectAddress"===e.name?t.editStatus=!0:t.setUpLoadUrl("")})},created:function(){this.getStatus(),this.getData()},destroyed:function(){this.setUpLoadUrl("")},methods:d()({},Object(_.c)(["getDescriptShopVal","initDescriptShopList","setDealTabStatus","setUpLoadUrl","setNewCustomerInfo"]),{getData:function(){var t=this;D.getCustomerDetails(this.$route.query.id).then(function(e){if(e.data){t.list=e.data;var s=t.changeStatus(t.list.orderList);t.list.orderList=s,t.getShopName(t.list.orgId),t.phone="0"===e.data.phone?"":e.data.phone,t.wechat=e.data.weChat}}).catch(function(e){510===e&&t.getData()})},getStatus:function(){var t=this;this.getType("FS_ORDER_STATUS"),setTimeout(function(){t.type=t._type},100)},changeStatus:function(t){var e=this;return t.map(function(t){t.status=Object(k.b)(e.type,t.status)}),t},editMsg:function(t){this.editStatus=t},saveMsg:function(){var t=this;return u()(i.a.mark(function e(){var s,n,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.newCustomerInfo.sex){e.next=3;break}return l.MessageBox.alert("性别不能为空"),e.abrupt("return");case 3:if(t.newCustomerInfo.username){e.next=6;break}return l.MessageBox.alert("称呼不能为空"),e.abrupt("return");case 6:if(/^[\u4e00-\u9fa5]{2,}$/.test(t.newCustomerInfo.username)){e.next=10;break}return l.MessageBox.alert("称呼只能输入中文且不能少于2个字"),e.abrupt("return");case 10:return e.next=12,t.recycleName(t.newCustomerInfo.username);case 12:if(s=e.sent,console.log(s,"ss"),s){e.next=17;break}return l.MessageBox.alert("姓氏不存在"),e.abrupt("return");case 17:if(n=f.a.testPhone(t.newCustomerInfo.phone),t.newCustomerInfo.phone&&""!==t.newCustomerInfo.phone||t.newCustomerInfo.weChat){e.next=21;break}return l.MessageBox.alert("请填写手机号码或微信号"),e.abrupt("return");case 21:if(t.newCustomerInfo.phone&&""!==t.newCustomerInfo.phone){e.next=26;break}if(""===t.phone||""!==t.newCustomerInfo.phone){e.next=25;break}return l.MessageBox.alert("手机号码不能修改为空"),e.abrupt("return");case 25:t.wx(t.newCustomerInfo.weChat);case 26:if(!t.newCustomerInfo.phone||t.phone===t.newCustomerInfo.phone){e.next=39;break}if(a=void 0,n){e.next=33;break}return l.MessageBox.alert("请填写正确手机号码"),e.abrupt("return");case 33:return e.next=35,t.checkPhone("phone",t.newCustomerInfo.phone);case 35:a=e.sent;case 36:if(!a){e.next=38;break}return e.abrupt("return");case 38:t.wx(t.newCustomerInfo.weChat);case 39:t.newCustomerInfo.phone&&t.phone===t.newCustomerInfo.phone&&t.wx(t.newCustomerInfo.weChat);case 40:case"end":return e.stop()}},e,t)}))()},wx:function(t){var e=this;return u()(i.a.mark(function s(){var n,a,r,o,u,c;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(n=f.a.testWeChat(t),a=void 0,!e.wechat||t){s.next=5;break}return l.MessageBox.alert("微信号不能修改为空"),s.abrupt("return");case 5:if(!t||e.wechat===t){s.next=17;break}if(n){s.next=11;break}return l.MessageBox.alert("请填写正确微信号"),s.abrupt("return");case 11:return s.next=13,e.checkPhone("wechat",t);case 13:a=s.sent,console.log(a);case 15:s.next=18;break;case 17:a=(t&&e.wechat,!1);case 18:if(!a){s.next=20;break}return s.abrupt("return");case 20:if(r=void 0,!e.newCustomerInfo.qq||""===e.newCustomerInfo.qq){s.next=27;break}return s.next=24,e.checkQQ();case 24:r=s.sent,s.next=28;break;case 27:r=!0;case 28:if(r){s.next=30;break}return s.abrupt("return");case 30:if(o=/^[\u4E00-\u9FA5a-zA-Z0-9]{1,}$/,""===e.newCustomerInfo.duty||o.test(e.newCustomerInfo.duty)){s.next=34;break}return l.MessageBox.alert("客户职业只能输入中英文或数字,不能包含空格"),s.abrupt("return");case 34:if(u=/[\ud800-\udbff][\udc00-\udfff]/g,c=/^[\u4E00-\u9FA5a-zA-Z0-9\s]{1,}$/,""===e.newCustomerInfo.remark||!u.test(e.newCustomerInfo.remark)){s.next=40;break}return e.newCustomerInfo.remark=e.newCustomerInfo.remark.replace(/[\ud800-\udbff][\udc00-\udfff]/g,""),l.MessageBox.alert("客户描述不支持表情"),s.abrupt("return");case 40:if(""===e.newCustomerInfo.remark||c.test(e.newCustomerInfo.remark)){s.next=43;break}return l.MessageBox.alert("客户描述不支持特殊符号"),s.abrupt("return");case 43:e.saveData();case 44:case"end":return s.stop()}},s,e)}))()},checkQQ:function(){var t=this;return u()(i.a.mark(function e(){var s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=void 0,/^[1-9][0-9]{4,9}$/.test(t.newCustomerInfo.qq)){e.next=8;break}return l.MessageBox.alert("请输入正确的QQ"),s=!1,e.abrupt("return");case 8:s=!0;case 9:return e.abrupt("return",s);case 10:case"end":return e.stop()}},e,t)}))()},checkName:function(t){var e=this;return u()(i.a.mark(function s(){var n;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=void 0,s.next=3,D.checkLastName({lastName:t}).then(function(t){console.log("检查名字",t),n=!!t.data}).catch(function(t){510===t&&e.checkName()});case 3:return s.abrupt("return",n);case 4:case"end":return s.stop()}},s,e)}))()},recycleName:function(t){var e=this;return u()(i.a.mark(function s(){var n,a,r,o;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:console.log("str",t),n=void 0,a=t.length-1,r=void 0,console.log(n),o=0;case 6:if(!(o<a)){s.next=15;break}return n=t.slice(0,o+1),s.next=10,e.checkName(n);case 10:return r=s.sent,s.abrupt("break",15);case 12:o++,s.next=6;break;case 15:return s.abrupt("return",r);case 16:case"end":return s.stop()}},s,e)}))()},checkPhone:function(t,e){var s=this;return u()(i.a.mark(function n(){var a,r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=void 0,r=void 0,r="phone"===t?"手机号":"微信号",n.next=5,I.a.getAjax("/v3/app/customer/check",{value:e,type:t,orgId:s.newCustomerInfo.orgId}).then(function(t){1==t.status&&(l.MessageBox.alert("该"+r+"已存在"),a=!0),0==t.status&&(a=!1,console.log(a))}).catch(function(t){510===t&&s.checkPhone()});case 5:return n.abrupt("return",a);case 6:case"end":return n.stop()}},n,s)}))()},saveData:function(){var t=this,e=new FormData;if(this.upLoadUrl){var s=this.changeFormData(this.upLoadUrl);e.append("dataFile",s,Date.now()+".jpg")}var n=this.updateParams(this.newCustomerInfo),a=[];for(var r in n)e.append(r,n[r]),a.push(r);D.updateCustomer(e,a,n).then(function(e){e.status?l.MessageBox.alert("更新成功").then(function(e){t.editStatus=!1,t.getData()}):l.MessageBox.alert("更新失败")}).catch(function(e){510===e&&t.saveData()})},changeFormData:function(t){for(var e=window.atob(t.split(",")[1]),s=new ArrayBuffer(e.length),n=new Uint8Array(s),a=0;a<e.length;a++)n[a]=e.charCodeAt(a);return new Blob([s],{type:"image/jpeg"})},updateParams:function(t){var e={},s={phone:t.phone?t.phone:"0",username:t.username,sex:t.sex,birthday:t.birthday,age:t.age,qq:t.qq,weChat:t.weChat,duty:t.duty,remark:t.remark,customerId:this.$route.query.id,orgId:t.orgId||this.list.orgId};for(var n in s)(s[n]||0===s[n])&&(e[n]=s[n]);return e},clickTab:function(t){this.setDealTabStatus(I.a.btnList(["订单信息","客户信息","意向信息"],t))},goBack:function(){this.$router.back(-1)},getShopId:function(t){var e=this;this.shops&&this.shops.length&&this.shops.forEach(function(s,n){s.name===t&&(e.shopId=s.crmId)}),this.$set(this.newCustomerInfo,"orgId",this.shopId),this.setNewCustomerInfo(this.newCustomerInfo)},getShopName:function(t){var e=this;this.shops&&this.shops.length&&this.shops.forEach(function(s,n){s.crmId===t&&(e.index=n)});var s=Object(S.a)(this.shops,this.index);this.initDescriptShopList(s),this.getDescriptShopVal()}}),activated:function(){if("no"===this.$route.query.edit?this.edit="no":this.edit="yes",!this.$route.meta.isUseCache){this.editStatus=!1;var t=localStorage.getItem("shops");this.shops=JSON.parse(t),this.getStatus(),this.getData(),this.$route.meta.customerUseCache=!1}},beforeRouteLeave:function(t,e,s){"address"===t.name||"chooseShop"===t.name?this.$route.meta.isUseCache=!0:(this.$route.meta.isUseCache=!1,this.setUpLoadUrl("")),s()}},"beforeRouteEnter",function(t,e,s){s(function(t){if("chooseShop"===e.name){var s=localStorage.getItem("shops");t.shops=JSON.parse(s),t.descriptShopVal&&t.getShopId(t.descriptShopVal)}})}),L={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"enquiryInfo"},[s("deal-header",{attrs:{list:t.list}}),t._v(" "),s("ul",{staticClass:"infoNav"},t._l(t.dealTabStatus,function(e,n){return s("li",{key:n,staticClass:"infoNavLi",class:{active:t.dealTabStatus[n].status},on:{click:function(e){return t.clickTab(n)}}},[s("span",[t._v(t._s(e.name))])])}),0),t._v(" "),s("order-info",{directives:[{name:"show",rawName:"v-show",value:t.dealTabStatus[0].status,expression:"dealTabStatus[0].status"}],attrs:{list:t.list}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.dealTabStatus[1].status,expression:"dealTabStatus[1].status"}]},[t.editStatus?s("div",[s("newDescript",{attrs:{select:!this.list.headPortrait,list:t.list,areaType:!0,type:"descript"}}),t._v(" "),s("btn",{staticClass:"theBtn",attrs:{text:"保存资料"},nativeOn:{touchend:function(e){return t.saveMsg()}}})],1):s("customer-msg",{attrs:{isedit:t.edit,list:t.list,editMsg:t.editMsg}})],1),t._v(" "),s("intentionMsg",{directives:[{name:"show",rawName:"v-show",value:t.dealTabStatus[2].status,expression:"dealTabStatus[2].status"}],attrs:{isedit:t.edit,list:t.list.opportunityList,orgId:t.list.orgId,phone:t.phone}})],1)},staticRenderFns:[]};var q=s("C7Lr")(y,L,!1,function(t){s("3jcx")},"data-v-92c79f38",null);e.default=q.exports},lsPn:function(t,e,s){"use strict";var n=s("WdeC"),a=s("cyB7"),r=s("vGYV"),i=(s("BvhE").Base64,{props:["list","editMsg","isedit"],components:{customerLi:n.a,btn:a.a},data:function(){return{shops:""}},mounted:function(){var t=localStorage.getItem("shops");this.shops=JSON.parse(t)},methods:{edit:function(){this.editMsg(!0)},toAddress:function(){"no"!==this.isedit&&this.$router.push({path:"/address/"+this.$route.query.id})},turnRemark:function(t){return r.a.textDecode(t)},getShopId:function(t){var e=void 0;return this.shops&&this.shops.length&&this.shops.forEach(function(s,n){s.crmId===t&&(e=s.name)}),e},turnDate:function(t){if(t){var e=t.split("-");return e.length>1?e[0]+"年"+e[1]+"月"+e[2]+"日":t}}}}),o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"customerMsg"},[s("ul",[s("customerLi",{tag:"li",attrs:{leftText:"客户生日"}},[t.list.birthday?s("span",[t._v(t._s(t.turnDate(t.list.birthday)))]):s("span",{staticClass:"unspan"},[t._v("未收集")])]),t._v(" "),s("customerLi",{tag:"li",attrs:{leftText:"客户年龄"}},[t.list.age?s("span",[t._v(t._s(t.list.age))]):s("span",{staticClass:"unspan"},[t._v("未收集")])]),t._v(" "),s("customerLi",{tag:"li",attrs:{leftText:"客户微信"}},[t.list.weChat?s("span",[t._v(t._s(t.list.weChat))]):s("span",{staticClass:"unspan"},[t._v("未收集")])]),t._v(" "),s("customerLi",{tag:"li",attrs:{leftText:"客户 QQ"}},[t.list.qq?s("span",[t._v(t._s(t.list.qq))]):s("span",{staticClass:"unspan"},[t._v("未收集")])]),t._v(" "),s("customerLi",{tag:"li",attrs:{leftText:"客户职业"}},[t.list.duty?s("span",[t._v(t._s(t.list.duty))]):s("span",{staticClass:"unspan"},[t._v("未收集")])]),t._v(" "),s("customerLi",{tag:"li",attrs:{leftText:"客户地区",icon:!0},nativeOn:{click:function(e){return t.toAddress(e)}}},[s("span",[t._v("地址管理")])]),t._v(" "),s("customerLi",{tag:"li",staticClass:"customerLi2",attrs:{leftText:"客户描述"}},[t.list.remark?s("span",[t._v(t._s(t.list.remark.replace(/\\n/g,"\r\n")))]):s("span",{staticClass:"unspan"},[t._v("未收集")])]),t._v(" "),s("customerLi",{tag:"li",attrs:{leftText:"所属门店"}},[t.list.orgId?s("span",{staticClass:"shop"},[t._v(t._s(t.getShopId(t.list.orgId)))]):s("span",{staticClass:"unspan"},[t._v("未收集")])])],1),t._v(" "),"no"!==t.isedit?s("btn",{staticClass:"myBtn",attrs:{text:"编辑资料"},nativeOn:{click:function(e){return t.edit()}}}):t._e()],1)},staticRenderFns:[]};var u=s("C7Lr")(i,o,!1,function(t){s("pW8u")},"data-v-9045504a",null);e.a=u.exports},pW8u:function(t,e){},zIWf:function(t,e,s){"use strict";s("xd7I"),s("e1F6"),s("HVJf");var n=s("vGYV"),a={props:{list:{type:[Object,Array],default:[],required:!1}},watch:{list:function(){this.list.addressId&&this.getAddress()}},data:function(){return{address:""}},methods:{getAddress:function(){var t=this,e=this.list.addressId;n.a.getAjax("/v2/app/address",{addressId:e}).then(function(e){e.data&&(t.address=e.data.provinceName+e.data.cityName+e.data.districtName+e.data.address+e.data.housingEstate)}).catch(function(e){510===e&&t.getAddress()})},turnDate:function(t){if(t){var e=t.split("-");return e.length>1?e[0]+"年"+e[1]+"月"+e[2]+"日":t}}}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"enquiryOrderInfo"},[s("div",{staticClass:"address-icon"}),t._v(" "),s("div",{staticClass:"address1"},[s("ul",[s("li",[t._v("\n        收货人："+t._s(t.list.username)+"\n        "),s("span",[t._v(t._s(t.list.phone))]),t._v(" "),s("div",{staticClass:"phone"})]),t._v(" "),s("li",[t._v("收获地址："+t._s(t.address))]),t._v(" "),s("li",[t._v("需求日期："+t._s(t.turnDate(t.list.demandTime)))])])])])},staticRenderFns:[]};var i=s("C7Lr")(a,r,!1,function(t){s("7d3Z")},"data-v-58b72748",null);e.a=i.exports}});
//# sourceMappingURL=10.b1693fa048cd5fb5e8ab.js.map
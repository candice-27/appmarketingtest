webpackJsonp([17],{"/4Fq":function(e,t){},"/YOE":function(e,t){},"9r/T":function(e,t,n){(function(e){var a=void 0!==e&&e||"undefined"!=typeof self&&self||window,s=Function.prototype.apply;function r(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new r(s.call(setTimeout,a,arguments),clearTimeout)},t.setInterval=function(){return new r(s.call(setInterval,a,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(a,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n("AYvJ"),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(t,n("9AUj"))},AYvJ:function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var a,s,r,o,i,c=1,u={},l=!1,m=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?a=function(e){t.nextTick(function(){p(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){p(e.data)},a=function(e){r.port2.postMessage(e)}):m&&"onreadystatechange"in m.createElement("script")?(s=m.documentElement,a=function(e){var t=m.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,s.removeChild(t),t=null},s.appendChild(t)}):a=function(e){setTimeout(p,0,e)}:(o="setImmediate$"+Math.random()+"$",i=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&p(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",i,!1):e.attachEvent("onmessage",i),a=function(t){e.postMessage(o+t,"*")}),h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var s={callback:e,args:t};return u[c]=s,a(c),c++},h.clearImmediate=d}function d(e){delete u[e]}function p(e){if(l)setTimeout(p,0,e);else{var t=u[e];if(t){l=!0;try{!function(e){var t=e.callback,a=e.args;switch(a.length){case 0:t();break;case 1:t(a[0]);break;case 2:t(a[0],a[1]);break;case 3:t(a[0],a[1],a[2]);break;default:t.apply(n,a)}}(t)}finally{d(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,n("9AUj"),n("V0EG"))},E2nm:function(e,t,n){"use strict";var a=n("4YfN"),s=n.n(a),r=n("vRRp"),o=n("HVJf"),i={props:["list","phone","orgId","isedit"],components:{intentionLi:r.a},data:function(){return{show:!0}},methods:s()({},Object(o.c)(["setCheckedList"]),{toIntentionDetails:function(e){this.$router.push({name:"intention",params:{opportunityId:this.list[e].oppId},query:{phone:this.phone,edit:this.isedit}})},newCustomer:function(){this.$router.push({path:"newIntention",query:{id:this.$route.query.id,orgId:this.orgId}})}})},c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"intentionMsg"},[n("ul",e._l(e.list,function(t,a){return n("intentionLi",{key:a,attrs:{list:t},nativeOn:{click:function(t){return e.toIntentionDetails(a)}}})}),1),e._v(" "),"no"!==e.isedit?n("button",{staticClass:"new",on:{click:e.newCustomer}}):e._e()])},staticRenderFns:[]};var u=n("C7Lr")(i,c,!1,function(e){n("/4Fq")},"data-v-4c39baa8",null);t.a=u.exports},Iakz:function(e,t){},"bcd+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("lC5x"),s=n.n(a),r=n("J0Oq"),o=n.n(r),i=n("4YfN"),c=n.n(i),u=n("a3Yh"),l=n.n(u),m=n("wSez"),h=n("0xDb"),d=n("CNcc"),p=n("HVJf"),f=n("cyB7"),v=n("iNX8"),g=n("rVsN"),x=n.n(g),C=n("xd7I"),y=n("WdeC"),I=n("8BZo"),b=n("Zdlb"),w=n("3buF"),D=n("zdYc"),S=n("2Ohe"),k=n("vGYV"),_=n("CqDD");n("9r/T");C.default.component(m.DatetimePicker.name,m.DatetimePicker),C.default.component(m.Picker.name,m.Picker),C.default.component(m.Popup.name,m.Popup),C.default.component(m.Switch.name,m.Switch);var N={name:"customerDescript",components:{customerLi:y.a,bigBtn:I.a,sexSelect:b.a,sourceSelect:w.a,leaveStoreSelect:D.a,areaSelect:S.a},data:function(){return{customerDemand:{},importantBtns:k.a.btnList(["高","中","低"],0),urgency:!1,slots:[],areaList:[],popupVisible:!1,proto:"",today:new Date,province:[],provinceName:"",city:[],cityName:"",county:[],countyName:""}},watch:{provinceName:function(){},cityName:function(){},countyName:function(){}},computed:c()({},Object(p.d)({customerInfo:function(e){return e.dealOrderInfoDetails.dealOrderInfoDetails},sexVal:function(e){return e.select.sexVal},areaVal:function(e){return e.select.areaVal},enterStoreVal:function(e){return e.select.enterStoreVal},sourceVal:function(e){return e.select.sourceVal},leaveStoreVal:function(e){return e.select.leaveStoreVal}}),{provinceNames:function(){return this.province.map(function(e){return e.name.slice(0,4)})},cityNames:function(){return this.city.map(function(e){return e.name})},countyNames:function(){return this.county.map(function(e){return e.name})}}),created:function(){var e=localStorage.getItem("ajaxData");this.ajaxData=JSON.parse(e),0!=this.$route.params.id&&this.getCustomerInfo()},mounted:function(){this.$set(this.customerDemand,"phone",this.$route.query.phone)},destroyed:function(){this.setSexVal(""),this.setAreaVal(""),this.setEnterStoreVal(""),this.setSourceVal(""),this.setLeaveStoreVal("")},methods:c()({},Object(p.c)(["setDealOrderInfoDetails","setSexVal","setAreaVal","setEnterStoreVal","setSourceVal","setLeaveStoreVal"]),{selectArea:function(e){console.log("选择的地区：",e)},getCustomerInfo:function(){var e=this,t=this.$route.params.id;k.a.getAjax(this,"customerById",{id:t,account:this.ajaxData.account},"v2").then(function(t){(t=t.data)&&(e.setDealOrderInfoDetails(t),e.setSelectVal(t),1==t.urgency?e.urgency=!0:e.urgency=!1,e.checkBtnStatus(t),e.$emit("setInfo",{name:t.username,phone:t.phone,sex:t.sex})),e.setCustomerDemand(t)}).catch(function(t){510===t&&e.getCustomerInfo()})},setSelectVal:function(e){this.setSexVal(1==e.sex?"男":0==e.sex?"未知":"女"),this.setAreaVal({provinceName:e.provinceName,provinceCode:e.provinceCode,cityName:e.cityName,cityCode:e.cityCode,countyName:e.areaName,countyCode:e.areaCode}),this.setEnterStoreVal(e.enterStore),e.source&&this.setSourceVal(e.source),this.setLeaveStoreVal(e.leaveStore)},setCustomerDemand:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.customerDemand={username:e.username,sex:e.sex,storeDate:this.returnDate(e.storeDate)||k.a.indexTimeB(new Date)[1],phone:e.phone||this.$route.query.phone,source:e.source,province:e.provinceCode,city:e.cityCode,area:e.areaCode,address:e.area||e.address,leaveStore:e.leaveStore,urgency:e.urgency,important:e.important}},checkBtnStatus:function(e){for(var t=0;t<this.importantBtns.length;t++)this.importantBtns[t].status=e.important-1===t},changeImportant:function(e){this.importantBtns.forEach(function(t,n){t.status=e===n}),this.customerDemand.important=e+1},selectStoreDate:function(){this.$refs.datePicker.open()},selectTime:function(){this.slots=this.leaveStoreList,this.proto="leaveStore",this.customerDemand.leaveStore=this.leaveStoreList[0].values[0],this.popupVisible=!0},setStoreDate:function(e){this.customerDemand.storeDate=k.a.indexTimeB(e)[1]},areaChange:function(e){console.log("选择的地区：",e),this.customerDemand.province=e.provinceCode,this.customerDemand.city=e.cityCode,this.customerDemand.area=e.countyCode},sexChange:function(e){this.customerDemand.sex="男"===e?1:2,this.setSexVal(e)},sourceChange:function(e){this.setSourceVal(e),this.customerDemand.source=e},leaveStoreChange:function(e){this.setLeaveStoreVal(e),this.customerDemand.leaveStore=e},onValuesChange:function(e,t){console.log(t),"area"===this.proto||("sex"===this.proto?this.customerDemand[this.proto]="男"===t[0]?"1":"2":this.customerDemand[this.proto]=t[0])},initData:function(){this.urgency?this.customerDemand.urgency=1:this.customerDemand.urgency=9,""!==this.customerDemand.username&&this.customerDemand.username||(this.customerDemand.username="无名氏"),this.customerDemand.sex="男"===this.sexVal?1:"未知"===this.sexVal?0:2,this.customerDemand.leaveStore=this.leaveStoreVal},saveCustomerInfo:function(){var e=this;if(d.a.testPhone(this.customerDemand.phone)){this.customerDemand,this.$route.params.id;this.initData(),k.a.getAjax(this,"customer/update",c()({account:this.ajaxData.account,tenantId:this.ajaxData.tenantId,customerId:0==this.$route.params.id?"":this.$route.params.id},Object(_.g)(this.customerDemand)),"v2","post").then(function(e){e&&k.a.tip("保存成功！")}).catch(function(t){510===t&&e.saveCustomerInfo()})}else k.a.tip("请填写正确的手机号码")},turnDate:function(e){if(e){var t=e.split("-");return t.length>1?t[0]+"年"+t[1]+"月"+t[2]+"日":e}},returnDate:function(e){if(e)return-1!==e.indexOf("年")?e.replace(/年/,"-").replace(/月/,"-").replace(/日/,""):e},getProvince:function(){var e=this;k.a.getAjax(this,"province",{},"v3").then(function(t){(t=t.data)&&(e.province=t,e.areaList=[{values:e.provinceNames,className:"slot1"}])}).catch(function(t){510===t&&e.getProvince()})},getCity:function(e){var t=this;k.a.key&&(k.a.key=!1,k.a.getAjax(this,"city",{province:e},"v3").then(function(e){k.a.key=!0,(e=e.data)&&(t.city=e,t.slots=[{values:t.provinceNames,className:"slot1"},{values:t.cityNames,className:"slot2"}])}).catch(function(n){510===n&&t.getCity(e)}))},getCounty:function(e){var t=this;return new x.a(function(n,a){k.a.getAjax(t,"area",{city:e},"v3").then(function(e){(e=e.data)&&(t.county=e,t.slots=[{values:t.provinceNames,className:"slot1"},{values:t.cityNames,className:"slot2"},{values:t.countyNames,className:"slot3"}]),n(e)}).catch(function(n){510===n&&t.getCounty(e)})})},setAreaData:function(e,t,n){this.areaList=[{values:e,className:"slot1"},{values:t,className:"slot2"},{values:n,className:"slot3"}]},searchCode:function(e,t){for(var n=0;n<e.length;n++)if(-1!==e[n].name.indexOf(t))return e[n].code}})},V={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"customerDescript"},[n("ul",[n("customerLi",{tag:"li",attrs:{leftText:"客户姓名"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.customerDemand.username,expression:"customerDemand.username"}],attrs:{type:"text",placeholder:"请填写客户姓名"},domProps:{value:e.customerDemand.username},on:{input:function(t){t.target.composing||e.$set(e.customerDemand,"username",t.target.value)}}})]),e._v(" "),n("sexSelect",{tag:"li",on:{sexChange:e.sexChange}}),e._v(" "),n("customerLi",{tag:"li",attrs:{leftText:"客户电话"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.customerDemand.phone,expression:"customerDemand.phone"}],attrs:{type:"text",placeholder:"请填写客户电话"},domProps:{value:e.customerDemand.phone},on:{input:function(t){t.target.composing||e.$set(e.customerDemand,"phone",t.target.value)}}})]),e._v(" "),n("areaSelect",{tag:"li",on:{areaChange:e.areaChange}}),e._v(" "),n("customerLi",{tag:"li",attrs:{leftText:"客户地址"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.customerDemand.address,expression:"customerDemand.address"}],attrs:{type:"text",placeholder:"请填写客户地址"},domProps:{value:e.customerDemand.address},on:{input:function(t){t.target.composing||e.$set(e.customerDemand,"address",t.target.value)}}})]),e._v(" "),n("customerLi",{tag:"li",attrs:{leftText:"进店日期",icon:!0},nativeOn:{click:function(t){return e.selectStoreDate(t)}}},[n("span",[e._v(e._s(e.turnDate(e.customerDemand.storeDate)||"请选择客户进店日期"))])]),e._v(" "),n("sourceSelect",{tag:"li",on:{sourceChange:e.sourceChange}}),e._v(" "),n("leaveStoreSelect",{tag:"li",on:{leaveStoreChange:e.leaveStoreChange}}),e._v(" "),n("li",{staticClass:"important"},[e._v("\n      关键程度\n      "),n("div",e._l(e.importantBtns,function(t,a){return n("button",{key:"importantBtns"+a,class:{on:t.status},on:{click:function(t){return e.changeImportant(a)}}},[e._v(e._s(t.name))])}),0)]),e._v(" "),n("li",{staticClass:"urgency"},[e._v("\n      是否紧急\n      "),e._v(" "),n("div",{staticClass:"switchBox"},[n("mt-switch",{model:{value:e.urgency,callback:function(t){e.urgency=t},expression:"urgency"}})],1)]),e._v(" "),n("li",[n("big-btn",{attrs:{text:"保存"},nativeOn:{click:function(t){return e.saveCustomerInfo(t)}}})],1)],1),e._v(" "),n("div",{staticClass:"mintComponent"},[n("mt-popup",{attrs:{position:"bottom"},model:{value:e.popupVisible,callback:function(t){e.popupVisible=t},expression:"popupVisible"}},[n("mt-picker",{ref:"Picker",attrs:{slots:e.slots},on:{change:e.onValuesChange}})],1),e._v(" "),n("mt-datetime-picker",{ref:"datePicker",attrs:{type:"date",startDate:new Date("1930-01-01"),"year-format":"{value} 年","month-format":"{value} 月","date-format":"{value} 日"},on:{confirm:e.setStoreDate},model:{value:e.today,callback:function(t){e.today=t},expression:"today"}})],1)])},staticRenderFns:[]};var T,L=n("C7Lr")(N,V,!1,function(e){n("Iakz")},"data-v-73905506",null).exports,B=n("A4bO"),M=n("E2nm"),$=n("lsPn"),O=n("TYi7"),A=new h.a,P=l()({name:"customerInfo",components:(T={btn:f.a,dealHeader:v.a,customerDescript:L,newDescript:B.a,intentionMsg:M.a},l()(T,"customerDescript",L),l()(T,"CustomerMsg",$.a),T),beforeRouteEnter:function(e,t,n){n(function(e){"selectAddress"===t.name?e.editStatus=!0:e.setUpLoadUrl("")})},data:function(){return{btns:k.a.btnList(["客户信息","意向信息"],0),list:[],editStatus:!1,shops:"",shpoId:"",index:"",phone:"",wechat:"",edit:""}},computed:c()({},Object(p.d)({customerTabStatus:function(e){return e.tabStatus.customerTabStatus},newCustomerInfo:function(e){return e.customer.newCustomerInfo},upLoadUrl:function(e){return e.loadImgUrl.upLoadUrl},descriptShopVal:function(e){return e.chooseShop.descriptShopVal}})),destroyed:function(){this.setUpLoadUrl("")},methods:c()({},Object(p.c)(["setNewCustomerInfo","setCustomerInfoBtns","setCustomerTabStatus","setUpLoadUrl","initDescriptShopList","getDescriptShopVal"]),{infoSelect:function(e){this.setCustomerTabStatus(k.a.btnList(["客户信息","意向信息"],e))},getData:function(){var e=this;A.getCustomerDetails(this.$route.query.id).then(function(t){t.data&&(e.list=t.data,e.phone="0"===e.list.phone?"":e.list.phone,e.wechat=e.list.weChat)}).catch(function(t){510===t&&e.getData()})},editMsg:function(e){this.editStatus=e},saveMsg:function(){var e=this;return o()(s.a.mark(function t(){var n,a,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.newCustomerInfo.sex){t.next=3;break}return m.MessageBox.alert("性别不能为空"),t.abrupt("return");case 3:if(e.newCustomerInfo.username){t.next=6;break}return m.MessageBox.alert("称呼不能为空"),t.abrupt("return");case 6:if(/^[\u4e00-\u9fa5]{2,}$/.test(e.newCustomerInfo.username)){t.next=10;break}return m.MessageBox.alert("称呼只能输入中文且不能少于2个字"),t.abrupt("return");case 10:return t.next=12,e.recycleName(e.newCustomerInfo.username);case 12:if(n=t.sent,console.log(n,"ss"),n){t.next=17;break}return m.MessageBox.alert("姓氏不存在"),t.abrupt("return");case 17:if(a=d.a.testPhone(e.newCustomerInfo.phone),e.newCustomerInfo.phone&&""!==e.newCustomerInfo.phone||e.newCustomerInfo.weChat){t.next=21;break}return m.MessageBox.alert("请填写手机号码或微信号"),t.abrupt("return");case 21:if(e.newCustomerInfo.phone&&""!==e.newCustomerInfo.phone){t.next=26;break}if(""===e.phone||""!==e.newCustomerInfo.phone){t.next=25;break}return m.MessageBox.alert("手机号码不能修改为空"),t.abrupt("return");case 25:e.wx(e.newCustomerInfo.weChat);case 26:if(!e.newCustomerInfo.phone||e.phone===e.newCustomerInfo.phone){t.next=39;break}if(r=void 0,a){t.next=33;break}return m.MessageBox.alert("请填写正确手机号码"),t.abrupt("return");case 33:return t.next=35,e.checkPhone("phone",e.newCustomerInfo.phone);case 35:r=t.sent;case 36:if(!r){t.next=38;break}return t.abrupt("return");case 38:e.wx(e.newCustomerInfo.weChat);case 39:e.newCustomerInfo.phone&&e.phone===e.newCustomerInfo.phone&&e.wx(e.newCustomerInfo.weChat);case 40:case"end":return t.stop()}},t,e)}))()},wx:function(e){var t=this;return o()(s.a.mark(function n(){var a,r,o,i,c,u;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=d.a.testWeChat(e),r=void 0,!t.wechat||e){n.next=5;break}return m.MessageBox.alert("微信号不能修改为空"),n.abrupt("return");case 5:if(!e||t.wechat===e){n.next=17;break}if(a){n.next=11;break}return m.MessageBox.alert("请填写正确微信号"),n.abrupt("return");case 11:return n.next=13,t.checkPhone("wechat",e);case 13:r=n.sent,console.log(r);case 15:n.next=18;break;case 17:r=(e&&t.wechat,!1);case 18:if(!r){n.next=20;break}return n.abrupt("return");case 20:if(o=void 0,!t.newCustomerInfo.qq||""===t.newCustomerInfo.qq){n.next=27;break}return n.next=24,t.checkQQ();case 24:o=n.sent,n.next=28;break;case 27:o=!0;case 28:if(o){n.next=30;break}return n.abrupt("return");case 30:if(i=/^[\u4E00-\u9FA5a-zA-Z0-9]{1,}$/,""===t.newCustomerInfo.duty||i.test(t.newCustomerInfo.duty)){n.next=34;break}return m.MessageBox.alert("客户职业只能输入中英文或数字,不能包含空格"),n.abrupt("return");case 34:if(c=/[\ud800-\udbff][\udc00-\udfff]/g,u=/^[\u4E00-\u9FA5a-zA-Z0-9\s]{1,}$/,""===t.newCustomerInfo.remark||!c.test(t.newCustomerInfo.remark)){n.next=40;break}return t.newCustomerInfo.remark=t.newCustomerInfo.remark.replace(/[\ud800-\udbff][\udc00-\udfff]/g,""),m.MessageBox.alert("客户描述不支持表情"),n.abrupt("return");case 40:if(""===t.newCustomerInfo.remark||u.test(t.newCustomerInfo.remark)){n.next=43;break}return m.MessageBox.alert("客户描述不支持特殊符号"),n.abrupt("return");case 43:t.saveData();case 44:case"end":return n.stop()}},n,t)}))()},checkQQ:function(){var e=this;return o()(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=void 0,/^[1-9][0-9]{4,9}$/.test(e.newCustomerInfo.qq)){t.next=8;break}return m.MessageBox.alert("请输入正确的QQ"),n=!1,t.abrupt("return");case 8:n=!0;case 9:return t.abrupt("return",n);case 10:case"end":return t.stop()}},t,e)}))()},checkName:function(e){var t=this;return o()(s.a.mark(function n(){var a;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=void 0,n.next=3,A.checkLastName({lastName:e}).then(function(e){console.log("检查名字",e),a=!!e.data}).catch(function(e){510===e&&t.checkName()});case 3:return n.abrupt("return",a);case 4:case"end":return n.stop()}},n,t)}))()},recycleName:function(e){var t=this;return o()(s.a.mark(function n(){var a,r,o,i;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:console.log("str",e),a=void 0,r=e.length-1,o=void 0,console.log(a),i=0;case 6:if(!(i<r)){n.next=15;break}return a=e.slice(0,i+1),n.next=10,t.checkName(a);case 10:return o=n.sent,n.abrupt("break",15);case 12:i++,n.next=6;break;case 15:return n.abrupt("return",o);case 16:case"end":return n.stop()}},n,t)}))()},checkPhone:function(e,t){var n=this;return o()(s.a.mark(function a(){var r,o;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r=void 0,o=void 0,o="phone"===e?"手机号":"微信号",a.next=5,k.a.getAjax("/v3/app/customer/check",{value:t,type:e,orgId:n.newCustomerInfo.orgId}).then(function(e){1==e.status&&(m.MessageBox.alert("该"+o+"已存在"),r=!0),0==e.status&&(r=!1,console.log(r))}).catch(function(e){510===e&&n.checkPhone()});case 5:return a.abrupt("return",r);case 6:case"end":return a.stop()}},a,n)}))()},saveData:function(){var e=this;console.log(this.newCustomerInfo);var t=new FormData;if(this.upLoadUrl){var n=this.changeFormData(this.upLoadUrl);t.append("dataFile",n,Date.now()+".jpg")}var a=this.updateParams(this.newCustomerInfo),s=[];for(var r in a)t.append(r,a[r]),s.push(r);A.updateCustomer(t,s,a).then(function(t){t.status?m.MessageBox.alert("更新成功").then(function(t){e.editStatus=!1,e.getData()}):m.MessageBox.alert("更新失败")}).catch(function(t){510===t&&e.saveData()})},changeFormData:function(e){for(var t=window.atob(e.split(",")[1]),n=new ArrayBuffer(t.length),a=new Uint8Array(n),s=0;s<t.length;s++)a[s]=t.charCodeAt(s);return new Blob([n],{type:"image/jpeg"})},updateParams:function(e){console.log(555,e);var t={},n={phone:e.phone?e.phone:"0",username:e.username,sex:e.sex,birthday:e.birthday,age:e.age,qq:e.qq,weChat:e.weChat,duty:e.duty,remark:e.remark,customerId:this.$route.query.id,orgId:e.orgId||this.list.orgId};for(var a in n)(n[a]||0===n[a])&&(t[a]=n[a]);return t},getShopId:function(e){var t=this;this.shops&&this.shops.length&&this.shops.forEach(function(n,a){n.name===e&&(t.shopId=n.crmId)}),this.$set(this.newCustomerInfo,"orgId",this.shopId),this.setNewCustomerInfo(this.newCustomerInfo)},getShopName:function(e){var t=this;this.shops&&this.shops.length&&this.shops.forEach(function(n,a){n.crmId===e&&(t.index=a)});var n=Object(O.a)(this.shops,this.index);this.initDescriptShopList(n),this.getDescriptShopVal()}}),activated:function(){if("no"===this.$route.query.edit?this.edit="no":this.edit="yes",!this.$route.meta.isUseCache){this.editStatus=!1;var e=localStorage.getItem("shops");this.shops=JSON.parse(e),this.getData(),this.$route.meta.customerUseCache=!1}},beforeRouteLeave:function(e,t,n){"address"===e.name||"chooseShop"===e.name?this.$route.meta.isUseCache=!0:(this.$route.meta.isUseCache=!1,this.setUpLoadUrl("")),n()}},"beforeRouteEnter",function(e,t,n){n(function(e){var n=localStorage.getItem("shops");"chooseShop"===t.name&&(e.shops=JSON.parse(n),e.descriptShopVal&&e.getShopId(e.descriptShopVal))})}),q={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"customerInfo"},[n("deal-header",{attrs:{list:e.list}}),e._v(" "),n("ul",{staticClass:"infoNav"},e._l(e.customerTabStatus,function(t,a){return n("li",{key:"customerInfoBtn"+a,class:{active:e.customerTabStatus[a].status},on:{click:function(t){return e.infoSelect(a)}}},[n("span",[e._v(e._s(t.name))])])}),0),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.customerTabStatus[0].status,expression:"customerTabStatus[0].status"}]},[e.editStatus?n("div",{staticStyle:{"margin-top":"2.666vw"}},[n("newDescript",{attrs:{select:!this.list.headPortrait,list:e.list,areaType:!0,type:"descript"}}),e._v(" "),n("btn",{staticClass:"theBtn",attrs:{text:"保存资料"},nativeOn:{click:function(t){return e.saveMsg()}}})],1):n("customer-msg",{attrs:{isedit:e.edit,list:e.list,editMsg:e.editMsg}})],1),e._v(" "),n("intentionMsg",{directives:[{name:"show",rawName:"v-show",value:e.customerTabStatus[1].status,expression:"customerTabStatus[1].status"}],attrs:{isedit:e.edit,list:e.list.opportunityList,orgId:e.list.orgId,phone:e.phone}})],1)},staticRenderFns:[]};var E=n("C7Lr")(P,q,!1,function(e){n("/YOE")},"data-v-10ff7499",null);t.default=E.exports},lsPn:function(e,t,n){"use strict";var a=n("WdeC"),s=n("cyB7"),r=n("vGYV"),o=(n("BvhE").Base64,{props:["list","editMsg","isedit"],components:{customerLi:a.a,btn:s.a},data:function(){return{shops:""}},mounted:function(){var e=localStorage.getItem("shops");this.shops=JSON.parse(e)},methods:{edit:function(){this.editMsg(!0)},toAddress:function(){"no"!==this.isedit&&this.$router.push({path:"/address/"+this.$route.query.id})},turnRemark:function(e){return r.a.textDecode(e)},getShopId:function(e){var t=void 0;return this.shops&&this.shops.length&&this.shops.forEach(function(n,a){n.crmId===e&&(t=n.name)}),t},turnDate:function(e){if(e){var t=e.split("-");return t.length>1?t[0]+"年"+t[1]+"月"+t[2]+"日":e}}}}),i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"customerMsg"},[n("ul",[n("customerLi",{tag:"li",attrs:{leftText:"客户生日"}},[e.list.birthday?n("span",[e._v(e._s(e.turnDate(e.list.birthday)))]):n("span",{staticClass:"unspan"},[e._v("未收集")])]),e._v(" "),n("customerLi",{tag:"li",attrs:{leftText:"客户年龄"}},[e.list.age?n("span",[e._v(e._s(e.list.age))]):n("span",{staticClass:"unspan"},[e._v("未收集")])]),e._v(" "),n("customerLi",{tag:"li",attrs:{leftText:"客户微信"}},[e.list.weChat?n("span",[e._v(e._s(e.list.weChat))]):n("span",{staticClass:"unspan"},[e._v("未收集")])]),e._v(" "),n("customerLi",{tag:"li",attrs:{leftText:"客户 QQ"}},[e.list.qq?n("span",[e._v(e._s(e.list.qq))]):n("span",{staticClass:"unspan"},[e._v("未收集")])]),e._v(" "),n("customerLi",{tag:"li",attrs:{leftText:"客户职业"}},[e.list.duty?n("span",[e._v(e._s(e.list.duty))]):n("span",{staticClass:"unspan"},[e._v("未收集")])]),e._v(" "),n("customerLi",{tag:"li",attrs:{leftText:"客户地区",icon:!0},nativeOn:{click:function(t){return e.toAddress(t)}}},[n("span",[e._v("地址管理")])]),e._v(" "),n("customerLi",{tag:"li",staticClass:"customerLi2",attrs:{leftText:"客户描述"}},[e.list.remark?n("span",[e._v(e._s(e.list.remark.replace(/\\n/g,"\r\n")))]):n("span",{staticClass:"unspan"},[e._v("未收集")])]),e._v(" "),n("customerLi",{tag:"li",attrs:{leftText:"所属门店"}},[e.list.orgId?n("span",{staticClass:"shop"},[e._v(e._s(e.getShopId(e.list.orgId)))]):n("span",{staticClass:"unspan"},[e._v("未收集")])])],1),e._v(" "),"no"!==e.isedit?n("btn",{staticClass:"myBtn",attrs:{text:"编辑资料"},nativeOn:{click:function(t){return e.edit()}}}):e._e()],1)},staticRenderFns:[]};var c=n("C7Lr")(o,i,!1,function(e){n("pW8u")},"data-v-9045504a",null);t.a=c.exports},pW8u:function(e,t){}});
//# sourceMappingURL=17.b7dc2c9bd90cd2df17b8.js.map
{"version":3,"sources":["webpack:///src/pages/Personal/feedback.vue","webpack:///./src/pages/Personal/feedback.vue?4f4b","webpack:///./src/pages/Personal/feedback.vue"],"names":["Base64","__webpack_require__","indexModel","utils","feedback","data","messageTip","showMessageBox","btnNum","type","tip","path","isClear","components","mybanner","banner","Btn","yanInput","messageBox","yanMessageBox","upload","filesUpload","computed","extends_default","Object","vuex_esm","remark","get","this","$store","state","set","val","updateRemark","phone","contact","updateContact","methods","submit","_this","valid","f","FormData","Files","length","i","append","obj","updateParams","keys","key","push","then","res","code","msg","setMessageBox","setFiles","setPicVal","catch","reject","tempObj","temp","feedbackInfo","encode","cancel","$router","go","getImgs","array","console","log","updateImgList","js","test","beforeRouteEnter","to","from","next","meta","isUseCache","vm","Personal_feedback","render","_vm","_h","$createElement","_c","_self","staticClass","staticStyle","position","border","attrs","title","_v","directives","name","rawName","value","expression","id","placeholder","maxlength","domProps","on","input","$event","target","composing","_s","ref","picLen","clear","_b","showIcon","model","callback","$$v","contactObj","text","nativeOn","click","scopedSlots","_u","fn","remove","proxy","_e","staticRenderFns","Component","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/84.39c2f653b2062a9fb682.js","sourcesContent":["<template>\r\n  <div class=\"feedback\">\r\n    <mybanner :title=\"title\" style=\"position:static;border:none;\"/>\r\n    <div class=\"textareaBox\">\r\n      <textarea name=\"\" id=\"\"  placeholder=\"请描述你的反馈意见，我们将不断改进\" maxlength=\"250\" v-model=\"remark\"></textarea>\r\n      <span>{{remark.length}}/250</span>\r\n    </div>\r\n    <upload ref=\"upload\" :path=\"path\" picLen='3' :clear=\"isClear\"/>\r\n    <div class=\"form\">\r\n      <yan-input v-bind=\"contactObj\" v-model=\"phone\" :showIcon=\"false\"/>\r\n    </div>\r\n    <btn text=\"提交\" @click.native=\"submit\"/>\r\n    <message-box :type=\"messageBox.type\" :btnNum='messageBox.btnNum' v-if=\"messageBox.showMessageBox\">\r\n      {{messageBox.tip}}\r\n    <template v-slot:btn-group>\r\n        <button type=\"button\" @click=\"remove\">移除</button>\r\n        <button type=\"button\" @click=\"cancel\">取消</button>\r\n    </template>\r\n    <template v-slot:btn>\r\n        <button type=\"button\" @click=\"cancel\">确定</button>\r\n    </template>\r\n  </message-box>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport mybanner from '../../components/banner'\r\nimport Btn from \"../../components/personal/Btn\"\r\nimport yanInput from \"../../components/yanInput\"\r\nimport messageBox from '../../components/msManage/yanMessageBox'\r\nimport upload from '../../components/upload/filesUpload'\r\nimport { mapState, mapMutations } from 'vuex'\r\nimport mango from '../../js'\r\nimport { IndexModel } from '../../utils'\r\nlet Base64 = require('js-base64').Base64\r\nconst indexModel=new IndexModel()\r\nexport default {\r\n  data () {\r\n    return {\r\n      messageTip:{\r\n        showMessageBox:false,\r\n        btnNum:1,\r\n        type:true,\r\n        tip:'提交成功！感谢您的反馈~'\r\n      },\r\n      path:'/feedback',\r\n      isClear:true\r\n    }\r\n  },\r\n  components:{\r\n      mybanner,\r\n      Btn,\r\n      yanInput,\r\n      messageBox,\r\n      upload\r\n  },\r\n  computed:{\r\n    ...mapState('feedback',['title','contactObj','messageBox']),\r\n    ...mapState(['Files']),\r\n    remark:{\r\n      get(){\r\n        return this.$store.state.feedback.remark\r\n      },\r\n      set(val){\r\n       this.updateRemark(val)\r\n      }\r\n    },\r\n    phone:{\r\n      get(){\r\n        return this.$store.state.feedback.contact\r\n      },\r\n      set(val){\r\n        this.updateContact(val)\r\n      }\r\n    }\r\n  },\r\n  methods:{\r\n    ...mapMutations('feedback',['setMessageBox','updateRemark','updateContact','updateImgList']),\r\n    ...mapMutations(['setFiles','setPicVal']),\r\n    submit(){\r\n      if(this.valid()){ \r\n           let f=new FormData();\r\n          if(this.Files.length>0){\r\n            for(let i=0;i<this.Files.length;i++){\r\n              f.append('dataFile',this.Files[i]);\r\n            }\r\n          }\r\n          let obj=this.updateParams()\r\n          let keys=[];\r\n          for(let key in obj){\r\n            f.append(key,obj[key])\r\n            keys.push(key)\r\n          }\r\n           indexModel.feedback(f,keys,obj).then(res => {\r\n            if(res.code===0){\r\n              this.messageTip.tip=res.msg;\r\n              this.messageTip.showMessageBox=true;\r\n              this.setMessageBox(this.messageTip);\r\n              this.updateRemark('');\r\n              this.updateContact('');\r\n              this.setFiles([]);\r\n              this.setPicVal([]);\r\n            }else{\r\n              this.messageTip.tip=res.msg;\r\n              this.messageTip.type=false;\r\n              this.messageTip.showMessageBox=true;\r\n              this.setMessageBox(this.messageTip);\r\n              this.updateRemark('');\r\n              this.updateContact('');\r\n              this.setFiles([]);\r\n              this.setPicVal([]);\r\n               \r\n            }\r\n          }).catch((reject) => {\r\n            if(reject === 510){\r\n              this.submit()\r\n            }\r\n          }) \r\n      }\r\n    \r\n     \r\n    },\r\n    updateParams(){\r\n      let tempObj={};\r\n      let temp={\r\n        'phone':this.phone,\r\n        'feedbackInfo':Base64.encode(this.remark)\r\n      }\r\n      for(let key in temp){\r\n        if(temp[key]||temp[key]===0){\r\n          tempObj[key]=temp[key]\r\n        }\r\n      }\r\n      return tempObj\r\n    },\r\n    cancel(){\r\n      this.messageTip.showMessageBox=false;\r\n      this.setMessageBox(this.messageTip);\r\n      if(this.messageTip.type){\r\n         this.$router.go(-1);\r\n      }\r\n    },\r\n    getImgs(array){\r\n     console.log(array);\r\n      this.updateImgList(array);\r\n    },\r\n    valid(){\r\n      if(this.remark==''){\r\n          mango.tip('反馈信息不能为空');\r\n          return false;\r\n      }\r\n      let reg=/^1[34578]\\d{9}$/;\r\n      if(this.phone!==''&&!reg.test(this.phone)){\r\n         mango.tip('请输入正确的手机号码');\r\n         return false;\r\n      }\r\n      return true;\r\n    }\r\n\r\n  },\r\n  beforeRouteEnter(to,from,next){\r\n    if(!to.meta.isUseCache){\r\n      next(vm => {\r\n        vm.updateRemark('');\r\n        vm.updateContact('');\r\n        vm.setFiles([]);\r\n        vm.setPicVal([]);\r\n        vm.path='/feedback';\r\n        vm.isClear=true;\r\n      })\r\n    }else{\r\n      next();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.feedback{\r\n  height:100vh;\r\n  .textareaBox{\r\n    position: relative;\r\n    width:100vw;\r\n    border-bottom: 1px solid #e1e1e1;\r\n    padding:3.466vw 4.533vw;\r\n    box-sizing: border-box;\r\n    background:#fff;\r\n    textarea::-moz-placeholder{\r\n      color:#909090;\r\n      font-size: 3.733vw;\r\n    }\r\n     textarea:-moz-placeholder{\r\n      color:#909090;\r\n      font-size: 3.733vw;\r\n    }\r\n    textarea::-ms-input-placeholder{\r\n      color:#909090;\r\n      font-size: 3.733vw;\r\n    }\r\n    textarea::-webkit-input-placeholder{\r\n      color:#909090;\r\n      font-size: 3.733vw;\r\n    }\r\n    textarea{\r\n      width:100%;\r\n      height:40.8vw;\r\n      font-size: 3.733vw;\r\n      color:#363636;\r\n      resize: none;\r\n      -webkit-tap-hightlight-color:rgba(0,0,0,0);\r\n    }\r\n    span{\r\n      position: absolute;\r\n      bottom:2.666vw;\r\n      right:4.533vw;\r\n      font-size: 2.4vw;\r\n      color:#909090;\r\n    }\r\n\r\n  }\r\n  .form{\r\n    border-top:1px solid #e1e1e1;\r\n    border-bottom: 1px solid #e1e1e1;\r\n    margin-bottom: 13.333vw;\r\n    background: #fff;\r\n    padding-left: 4.266vw;\r\n  }\r\n}\r\n\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/Personal/feedback.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"feedback\"},[_c('mybanner',{staticStyle:{\"position\":\"static\",\"border\":\"none\"},attrs:{\"title\":_vm.title}}),_vm._v(\" \"),_c('div',{staticClass:\"textareaBox\"},[_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.remark),expression:\"remark\"}],attrs:{\"name\":\"\",\"id\":\"\",\"placeholder\":\"请描述你的反馈意见，我们将不断改进\",\"maxlength\":\"250\"},domProps:{\"value\":(_vm.remark)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.remark=$event.target.value}}}),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.remark.length)+\"/250\")])]),_vm._v(\" \"),_c('upload',{ref:\"upload\",attrs:{\"path\":_vm.path,\"picLen\":\"3\",\"clear\":_vm.isClear}}),_vm._v(\" \"),_c('div',{staticClass:\"form\"},[_c('yan-input',_vm._b({attrs:{\"showIcon\":false},model:{value:(_vm.phone),callback:function ($$v) {_vm.phone=$$v},expression:\"phone\"}},'yan-input',_vm.contactObj,false))],1),_vm._v(\" \"),_c('btn',{attrs:{\"text\":\"提交\"},nativeOn:{\"click\":function($event){return _vm.submit($event)}}}),_vm._v(\" \"),(_vm.messageBox.showMessageBox)?_c('message-box',{attrs:{\"type\":_vm.messageBox.type,\"btnNum\":_vm.messageBox.btnNum},scopedSlots:_vm._u([{key:\"btn-group\",fn:function(){return [_c('button',{attrs:{\"type\":\"button\"},on:{\"click\":_vm.remove}},[_vm._v(\"移除\")]),_vm._v(\" \"),_c('button',{attrs:{\"type\":\"button\"},on:{\"click\":_vm.cancel}},[_vm._v(\"取消\")])]},proxy:true},{key:\"btn\",fn:function(){return [_c('button',{attrs:{\"type\":\"button\"},on:{\"click\":_vm.cancel}},[_vm._v(\"确定\")])]},proxy:true}],null,false,1033094542)},[_vm._v(\"\\n    \"+_vm._s(_vm.messageBox.tip)+\"\\n  \")]):_vm._e()],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-556313c8\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/pages/Personal/feedback.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-556313c8\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./feedback.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./feedback.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./feedback.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-556313c8\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./feedback.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-556313c8\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/Personal/feedback.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}
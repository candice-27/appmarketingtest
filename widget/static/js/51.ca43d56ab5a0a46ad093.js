webpackJsonp([51],{"5Tr7":function(e,t){},"i+Dr":function(e,t){},oDBS:function(e,t){},qhdv:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("aA9S"),s=a.n(o),r=a("4YfN"),n=a.n(r),i=(a("xd7I"),a("YV7O")),l=a("WoPn"),d=a("OVlV"),c=a("ZaQL"),u=a("UaEH"),f=a("otx3"),p=a("T0rX"),m=a("yN+A"),v=a("vRxf"),y=a("TB9H"),h=a("RrjH"),_=a("W4OY"),g=a("ab77"),I=a("ijls"),b=a("+ZJN"),N=a("YVni"),R=a("EfbY"),C=a("l6Gh"),L=(a("90w1"),{props:["orderList"],data:function(){return{}},components:{yanInput:d.a},computed:{},created:function(){},mounted:function(){},methods:{}}),P={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",{staticClass:"orderList"},[a("li",[a("yan-input",{attrs:{label:"订单编号",readonly:"",value:e.orderList.orderNo,color:"font-weight:bold;color:#55A5FD"}})],1),e._v(" "),a("li",[a("yan-input",{attrs:{label:"订单产品",readonly:"",value:e.orderList.orderItemList[0].goodsName}})],1),e._v(" "),a("li",[a("yan-input",{attrs:{label:"下单时间",readonly:"",value:e.orderList.orderTime}})],1),e._v(" "),a("li",[a("yan-input",{attrs:{label:"需求日期",readonly:"",value:e.orderList.demandTime}})],1),e._v(" "),a("li",[a("yan-input",{attrs:{label:"订单折扣",readonly:"",value:e.orderList.discount}})],1),e._v(" "),a("li",[a("yan-input",{attrs:{label:"成交金额",readonly:"",value:e.orderList.total}})],1)])},staticRenderFns:[]};var D=a("C7Lr")(L,P,!1,function(e){a("5Tr7")},"data-v-58f9cfe0",null).exports,w=a("tqtp"),S={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"yan-layer-shade"},[o("div",{staticClass:"yan-layer-box"},[o("div",{staticClass:"yan-layer-content"},[o("img",{attrs:{src:a("9WxU"),alt:""}}),e._v(" "),o("div",{staticClass:"yan-layer-list"},e._l(e.info,function(t,a){return o("div",{key:a,staticClass:"yan-layer-item"},[o("span",[e._v(e._s(t.title))]),e._v(" "),o("span",[e._v(e._s(t.value))])])}),0),e._v(" "),o("div",{staticClass:"yan-btn-group"},[o("div",{staticClass:"yan-btn",on:{click:e.update}},[e._t("confirm")],2)])])])])},staticRenderFns:[]};var k=a("C7Lr")({props:["info"],data:function(){return{}},methods:{update:function(){this.$emit("confirm")}}},S,!1,function(e){a("oDBS")},"data-v-12e708bc",null).exports,x=a("KkR3"),T=(a("wSez"),a("HVJf")),A=a("vGYV"),U=a("0xDb"),O=(a("BvhE").Base64,new U.a),$={data:function(){return{padding:"",form:{goodsList:[],shopName:"",arrivalDate:"",sourceName:"",buyReasonName:"",stylePrefName:"",progressName:"",competingGoods:"",colorPrefName:"",deliverDate:"",remark:"",level:"",status:"",recordList:[],orderList:[]},selectIcon:!1,readonly:!0,failReason:"",isPrompt:!1,isMsg:!1,oppId:"",goodsValue:"",address:"",apartmentTypeName:"",elevator:"",argreeDiscount:"",urgency:"",budget:"",depositPaid:"",list:[{title:"创建时间：",value:""},{title:"流失时间：",value:""},{title:"流失原因：",value:""}],customerId:"",isRecord:!1,UpdateRedirect:"",argreeDiscountTxt:"",phone:"",placeholder:"已成单"}},components:{mybanner:i.a,yanInput:d.a,yanTextarea:u.a,dateSelect:m.a,titleBar:l.a,intentionSelect:f.a,storeSelect:p.a,durationSelect:v.a,sourceSelect:y.a,addressSelect:h.a,reasonSelect:_.a,styleSelect:g.a,progressSelect:b.a,classifySelect:R.a,recordPannel:C.a,orderInfo:D,yanLayerPrompt:w.a,yanLayerMsg:k,colorSelect:I.a,discountSelect:N.a,newRecord:x.a,yanOneInput:c.a},computed:n()({},Object(T.d)("intention",["title","formInfo","titleModule"])),watch:{$route:function(e,t){"/CustomerInfo"===t.name&&(this.UpdateRedirect=t.fullPath),"/enquiryInfo"===t.name&&(this.UpdateRedirect=t.fullPath)}},created:function(){this.phone=this.$route.query.phone,this.getOpportunity()},mounted:function(){},methods:n()({},Object(T.c)("intention",["setClassify","setUrgency","setTitle"]),Object(T.c)(["setCheckedList","setAddressId","setFiles","setPicVal"]),{getOpportunity:function(){var e=this,t=this.$route.params.opportunityId;O.getOpportunity(t).then(function(t){if(0===t.code){if(e.oppId=t.data.oppId,e.customerId=t.data.customerId,t.data.goodsList.length>0){var a=[];t.data.goodsList.map(function(e,t){var o=e.goodsName+",数量："+e.quantity;a.push(o)}),e.goodsValue=a.join("、")}"Approved"===t.data.status&&t.data.orderList.length>0&&(e.form.orderList=t.data.orderList),e.form.status=t.data.status,e.form.shopName=""===t.data.shopId?"未收集":e.getShopName(t.data.shopId),e.form.arrivalDate=t.data.arrivalDate,e.form.sourceName=t.data.sourceName,e.form.buyReasonName=""==t.data.buyReasonName?"未收集":t.data.buyReasonName,e.form.stylePrefName=""==t.data.stylePrefName?"未收集":t.data.stylePrefName,e.form.progressName=""==t.data.progressName?"未收集":t.data.progressName,e.form.competingGoods=""==t.data.competingGoods?"未收集":t.data.competingGoods,e.form.colorPrefName=""==t.data.colorPrefName?"未收集":t.data.colorPrefName,e.form.deliverDate=""==t.data.deliverDate?"未收集":t.data.deliverDate,e.form.remark=""==t.data.remark?"未备注":t.data.remark.replace(/\\n/g,"\r\n"),e.budget=t.data.budget,e.depositPaid=t.data.depositPaid,e.argreeDiscount=t.data.argreeDiscount,""!==t.data.argreeDiscount?e.argreeDiscountTxt=parseFloat(t.data.argreeDiscount)/10+"折":e.argreeDiscountTxt=0,e.form.level=""===t.data.level?"A":t.data.level,t.data.level?e.setClassify([t.data.level]):e.setClassify(["A"]),t.data.recordList.length>0&&(e.form.recordList=t.data.recordList),!0===t.data.urgency?(e.urgency="是",e.setUrgency(["是"])):(e.urgency="否",e.setUrgency(["否"])),e.list=[{title:"创建时间：",value:t.data.createTime},{title:"流失时间：",value:t.data.closeTime},{title:"流失原因：",value:t.data.closeReason}];""===t.data.addressId||e.getAddress(t.data.addressId)}else A.a.tip(t.msg)}).catch(function(t){510===t&&e.getOpportunity()})},modify:function(){this.$router.replace({name:"updateintention",params:{customerId:this.customerId},query:{oppId:this.oppId,phone:this.phone}})},close:function(){this.isPrompt=!0},closeReason:function(){this.isMsg=!0},layerUpdate:function(e){var t=this;if(""!==e){var a=void 0;if("2"===e){if(""===this.failReason)return void A.a.tip("流失原因不能为空");if(this.failReason.length>300)return void A.a.tip("流失原因不能超过300字");if(""!==this.failReason&&/[\ud800-\udbff][\udc00-\udfff]/g.test(this.failReason))return void A.a.tip("流失原因不支持表情");if(""!==this.failReason&&!/^[\u4E00-\u9FA5a-zA-Z0-9\s]{1,}$/.test(this.failReason))return void A.a.tip("流失原因不支持特殊符号");var o={opportunityId:this.oppId,closeReason:this.failReason,type:e};a=s()({},o)}else{if("未收集"===this.form.deliverDate)return void A.a.tip("需求日期不能为空");if(""===this.phone||"0"===this.phone||0===this.phone)return void A.a.tip("客户手机号码不能为空");var r={opportunityId:this.oppId,closeReason:"已成单",type:e};a=s()({},r)}O.closeOpportunity(a).then(function(e){0===e.code?(A.a.tip(e.msg),t.isPrompt=!1,t.$router.go(-1)):(A.a.tip(e.msg),t.isPrompt=!0)}).catch(function(e){510===e&&t.layerUpdate()})}else A.a.tip("请选择是否成单")},layerCancel:function(){this.isPrompt=!1},confirm:function(){this.isMsg=!1},addRecord:function(){this.$router.push({name:"followRecord",query:{oppId:this.oppId}})},sumitRecord:function(){this.isRecord=!1,this.setTitle("意向详情")},getAddress:function(e){var t=this;this.setAddressId(e),O.getAddress(e).then(function(e){0===e.code?(t.address=""+e.data.provinceName+e.data.cityName+e.data.districtName+e.data.address,t.apartmentTypeName=e.data.apartmentTypeName,t.elevator="Y"===e.data.elevator?"有电梯":"无电梯"):A.a.tip(e.msg)}).catch(function(a){510===a&&t.getAddress(e)})},getShopName:function(e){var t=void 0;return JSON.parse(localStorage.getItem("shops")).map(function(a,o){if(a.id===e)return t=a.name}),t}}),beforeRouteEnter:function(e,t,a){if("/CustomerInfo"===t.name){var o=t.fullPath;a(function(e){e.UpdateRedirect=o})}if("/enquiryInfo"===t.name){var s=t.fullPath;a(function(e){e.UpdateRedirect=s})}a()},beforeRouteLeave:function(e,t,a){"updateintention"===e.name&&(e.meta.isUseCache=!1,a()),"followRecord"===e.name&&(e.meta.isUseCache=!1,a()),a()}},q={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"addAdress"},[a("mybanner",{style:{background:"#f8f8f8"},attrs:{title:e.title}},["no"!==e.$route.query.edit?[e.isRecord?a("button",{staticClass:"button save",attrs:{type:"button"},on:{click:e.addRecord}},[e._v("保存")]):e._e(),e._v(" "),"New"!==e.form.status||e.isRecord?e._e():a("button",{staticClass:"button",staticStyle:{color:"#FF3B30"},attrs:{type:"button"},on:{click:e.close}},[e._v("意向关闭")])]:e._e(),e._v(" "),"Closed"===e.form.status?a("button",{staticClass:"button",staticStyle:{color:"#FF3B30"},attrs:{type:"button"},on:{click:e.closeReason}},[e._v("流失原因")]):e._e()],2),e._v(" "),a("div",[a("title-bar",{attrs:{text:e.titleModule.info}},["no"!==e.$route.query.edit?["New"===e.form.status?a("button",{attrs:{type:"button"},on:{click:e.modify}},[e._v("修改")]):e._e()]:e._e()],2),e._v(" "),a("ul",{staticClass:"list"},[a("li",[a("intention-select",e._b({attrs:{value:e.goodsValue,showIcon:e.selectIcon}},"intention-select",e.formInfo.intention,!1))],1),e._v(" "),a("li",[a("store-select",e._b({attrs:{value:e.form.shopName,showIcon:e.selectIcon}},"store-select",e.formInfo.store,!1))],1),e._v(" "),a("li",[a("date-select",e._b({attrs:{value:e.form.arrivalDate,showIcon:e.selectIcon}},"date-select",e.formInfo.time,!1))],1),e._v(" "),a("li"),a("li",[a("source-select",e._b({attrs:{value:e.form.sourceName,showIcon:e.selectIcon}},"source-select",e.formInfo.source,!1))],1)]),e._v(" "),a("ul",{staticClass:"list"},[a("li",[a("address-select",e._b({attrs:{value:e.address,showIcon:e.selectIcon}},"address-select",e.formInfo.address,!1))],1),e._v(" "),a("li",[a("yan-input",e._b({attrs:{value:e.apartmentTypeName,readonly:e.readonly}},"yan-input",e.formInfo.house,!1))],1),e._v(" "),a("li",[a("yan-input",e._b({attrs:{value:e.elevator,readonly:e.readonly}},"yan-input",e.formInfo.elevator,!1))],1),e._v(" "),a("li",[a("reason-select",e._b({attrs:{value:e.form.buyReasonName,showIcon:e.selectIcon}},"reason-select",e.formInfo.reason,!1))],1),e._v(" "),a("li",[a("style-select",e._b({attrs:{value:e.form.stylePrefName,showIcon:e.selectIcon}},"style-select",e.formInfo.style,!1))],1),e._v(" "),a("li",[a("progress-select",e._b({attrs:{value:e.form.progressName,showIcon:e.selectIcon}},"progress-select",e.formInfo.progress,!1))],1)]),e._v(" "),a("ul",{staticClass:"list"},[a("li",{staticStyle:{"border-top":"1px solid transparent"}},[a("yan-one-input",e._b({attrs:{value:e.form.competingGoods,readonly:e.readonly}},"yan-one-input",e.formInfo.goods,!1))],1),e._v(" "),a("li",[a("color-select",e._b({attrs:{value:e.form.colorPrefName,showIcon:e.selectIcon}},"color-select",e.formInfo.color,!1))],1),e._v(" "),a("li",[a("yan-input",e._b({attrs:{value:e.budget,readonly:e.readonly}},"yan-input",e.formInfo.budget,!1))],1),e._v(" "),a("li",[a("date-select",e._b({attrs:{value:e.form.deliverDate,showIcon:e.selectIcon}},"date-select",e.formInfo.deliver,!1))],1),e._v(" "),a("li",[a("yan-input",e._b({attrs:{value:e.depositPaid,readonly:e.readonly}},"yan-input",e.formInfo.paid,!1))],1),e._v(" "),a("li",[a("discount-select",e._b({attrs:{value:e.argreeDiscountTxt,showIcon:e.selectIcon}},"discount-select",e.formInfo.discount,!1))],1)]),e._v(" "),a("yan-textarea",e._b({attrs:{readonly:e.readonly,value:e.form.remark}},"yan-textarea",e.formInfo.remark,!1)),e._v(" "),a("div",{staticClass:"select"},[a("classify-select",{staticStyle:{"margin-bottom":"2.666vw"},attrs:{label:"意向分类",name:"classify",checked:e.form.level,options:e.formInfo.classify}}),e._v(" "),a("classify-select",{attrs:{label:"是否紧急",name:"urgency",checked:e.urgency,options:e.formInfo.urgency}})],1),e._v(" "),a("div",[a("title-bar",{attrs:{text:e.titleModule.report}},["no"!==e.$route.query.edit?["New"===e.form.status?a("button",{attrs:{type:"button"},on:{click:e.addRecord}},[e._v("添加记录")]):e._e()]:e._e()],2),e._v(" "),a("record-pannel",{attrs:{recordList:e.form.recordList}})],1),e._v(" "),"Approved"===e.form.status?a("div",[a("title-bar",{attrs:{text:e.titleModule.order}}),e._v(" "),e._l(e.form.orderList,function(e,t){return a("order-info",{key:t,staticClass:"order",attrs:{orderList:e}})})],2):e._e(),e._v(" "),a("p",{staticClass:"last"},[e._v("到底啦")]),e._v(" "),e.isPrompt?a("yan-layer-prompt",{on:{update:e.layerUpdate,cancel:e.layerCancel},model:{value:e.failReason,callback:function(t){e.failReason=t},expression:"failReason"}},[a("span",{attrs:{slot:"update"},slot:"update"},[e._v("确定")]),e._v(" "),a("span",{attrs:{slot:"cancel"},slot:"cancel"},[e._v("取消")])]):e._e(),e._v(" "),e.isMsg?a("yan-layer-msg",{attrs:{info:e.list},on:{confirm:e.confirm}},[a("span",{attrs:{slot:"confirm"},slot:"confirm"},[e._v("确定")])]):e._e()],1)],1)},staticRenderFns:[]};var F=a("C7Lr")($,q,!1,function(e){a("i+Dr")},"data-v-34c3937a",null);t.default=F.exports}});
//# sourceMappingURL=51.ca43d56ab5a0a46ad093.js.map